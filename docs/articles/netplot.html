<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Network Plots • BGGM</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Network Plots">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BGGM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/donaldRwilliams/BGGM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Network Plots</h1>
                        <h4 data-toc-skip class="author">Donny
Williams</h4>
            
            <h4 data-toc-skip class="date">5/20/2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/donaldRwilliams/BGGM/blob/HEAD/vignettes/netplot.Rmd" class="external-link"><code>vignettes/netplot.Rmd</code></a></small>
      <div class="d-none name"><code>netplot.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette shows how to make network plots.</p>
<div class="section level4">
<h4 id="r-packages">R packages<a class="anchor" aria-label="anchor" href="#r-packages"></a>
</h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># need the developmental version</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span>   </span>
<span><span class="op">}</span>   </span>
<span></span>
<span><span class="co"># install from github</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"donaldRwilliams/BGGM"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://donaldrwilliams.github.io/BGGM/">BGGM</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="estimate">Estimate<a class="anchor" aria-label="anchor" href="#estimate"></a>
</h2>
<p>For the estimate methods, it is currently only possible detect
non-zero relations and the others are set to zero (no connection in the
graph). In a future release, it will be possible to define a region of
equivalence to directly assess null values. Hence, it is important to
note those nodes not connected are not necessarily conditionally
independent (absence of evidence is not evidence of absence).</p>
<div class="section level3">
<h3 id="fit-model">Fit Model<a class="anchor" aria-label="anchor" href="#fit-model"></a>
</h3>
<p>In this example, I use the <code>bfi</code> data which consists of 25
variables measureing different aspects of personality.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># data</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">bfi</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># fit model</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.html">estimate</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="select-graph">Select Graph<a class="anchor" aria-label="anchor" href="#select-graph"></a>
</h3>
<p>The next step is to selec the graph or those relations for which the
credible excludes zero</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># select the edge set</span></span>
<span><span class="va">E</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select.html">select</a></span><span class="op">(</span><span class="va">fit</span>, </span>
<span>            cred <span class="op">=</span> <span class="fl">0.95</span>, </span>
<span>            alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span></span></code></pre></div>
<p><code>alternative</code> can be changed to, say,
<code>"greater"</code> which would then perform a one-sided hypothesis
test for postive relations. This is ideal for many applications in
psychology, because often <strong>all</strong> relations are expected to
be positive.</p>
</div>
<div class="section level3">
<h3 id="plot-graph">Plot Graph<a class="anchor" aria-label="anchor" href="#plot-graph"></a>
</h3>
<p>Here is the basic plot. This works for any object from
<code>select</code> (e.g., comparing groups).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">E</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/netplot_1.png"></p>
<div class="section level4">
<h4 id="customize-plot">Customize Plot<a class="anchor" aria-label="anchor" href="#customize-plot"></a>
</h4>
<p>The above is <code>ggplot</code> that can be futher honed in. Here is
an example.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># extract communities</span></span>
<span><span class="va">comm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substring</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">E</span>, </span>
<span>     <span class="co"># enlarge edges</span></span>
<span>     edge_magnify <span class="op">=</span> <span class="fl">5</span>, </span>
<span>     <span class="co"># cluster nodes</span></span>
<span>     groups <span class="op">=</span> <span class="va">comm</span>, </span>
<span>     <span class="co"># change layout</span></span>
<span>     layout <span class="op">=</span> <span class="st">"circle"</span><span class="op">)</span><span class="op">$</span><span class="va">plt</span> <span class="op">+</span></span>
<span>  <span class="co"># add custom labels</span></span>
<span>  <span class="fu">scale_color_brewer</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, </span>
<span>                                <span class="st">"C"</span>, </span>
<span>                                <span class="st">"E"</span>, </span>
<span>                                <span class="st">"N"</span>, </span>
<span>                                <span class="st">"O"</span><span class="op">)</span>, </span>
<span>                     labels <span class="op">=</span>   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Agreeableness"</span>, <span class="st">"Conscientiousness"</span>, </span>
<span>                                  <span class="st">"Extraversion"</span>, <span class="st">"Neuroticism"</span>, </span>
<span>                                  <span class="st">"Opennness"</span><span class="op">)</span>,</span>
<span>                     palette <span class="op">=</span> <span class="st">"Set2"</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/netplot_2.png"></p>
<p>The <code>edge_magnify</code> is a value that is multiplied by the
edges, <code>groups</code> allows for grouping the variables (e.g.,
those thought to belong to the same “community” will be the same color),
and the <code>scale_color_brewer</code> is from the package
<code>ggplot2</code> (<code>pallete</code> controls the color of the
<code>groups</code>). By default the edge colors are from a color blind
palette. This can be changed in <code>plot</code> with the arguments
<code>pos_col</code> (the color for positive edges) and
<code>pos_neg</code> (the color for negative edges).</p>
<p>This is just scratching the surface of possibilities, as essentially
any change can be made to the plot. There is lots of support for making
nice plots readily available online.</p>
<div class="section level5">
<h5 id="layout">Layout<a class="anchor" aria-label="anchor" href="#layout"></a>
</h5>
<p>It is also possible to change the layout. This is done with the
<strong>sna</strong> package, which is linked in the documentation for
<code>plot.select</code> in <strong>BGGM</strong>. Here is an example
using <code>layout = "random"</code></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">E</span>, </span>
<span>     <span class="co"># enlarge edges</span></span>
<span>     edge_magnify <span class="op">=</span> <span class="fl">5</span>, </span>
<span>     <span class="co"># cluster nodes</span></span>
<span>     groups <span class="op">=</span> <span class="va">comm</span>, </span>
<span>     <span class="co"># change layout</span></span>
<span>     layout <span class="op">=</span> <span class="st">"random"</span><span class="op">)</span><span class="op">$</span><span class="va">plt</span> <span class="op">+</span></span>
<span>  <span class="co"># add custom labels</span></span>
<span>  <span class="fu">scale_color_brewer</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, </span>
<span>                                <span class="st">"C"</span>, </span>
<span>                                <span class="st">"E"</span>, </span>
<span>                                <span class="st">"N"</span>, </span>
<span>                                <span class="st">"O"</span><span class="op">)</span>, </span>
<span>                     labels <span class="op">=</span>   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Agreeableness"</span>, <span class="st">"Conscientiousness"</span>, </span>
<span>                                  <span class="st">"Extraversion"</span>, <span class="st">"Neuroticism"</span>, </span>
<span>                                  <span class="st">"Opennness"</span><span class="op">)</span>,</span>
<span>                     palette <span class="op">=</span> <span class="st">"Set2"</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/netplot_3.png"></p>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="bayesian-hypothesis-testing">Bayesian Hypothesis Testing<a class="anchor" aria-label="anchor" href="#bayesian-hypothesis-testing"></a>
</h2>
<p>The Bayesian hypothesis testing methods offer several advantages, for
example, that evidence for the null hypothesis of conditional
independence is formally evaluated. As a result, the
<code>explore</code> method in <strong>BGGM</strong> provides plots for
both the conditional dependence and independence structure, in addition
to a plot for which the evidence was ambiguous.</p>
<p>To highlight this advantage, <code>ptsd</code> data is used that has
a relatively small sample size.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fit model</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/explore.html">explore</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span></span>
<span></span>
<span><span class="va">E</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select.html">select</a></span><span class="op">(</span><span class="va">fit</span>, BF_cut <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>Then plot the results. Note that there are three plots, so the
package <strong>cowplot</strong> is used to combine them into one
plot.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">E</span>, </span>
<span>             edge_magnify <span class="op">=</span> <span class="fl">5</span>, </span>
<span>             groups <span class="op">=</span> <span class="va">comm</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span></span>
<span><span class="va">plts</span><span class="op">$</span><span class="va">H1_plt</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Conditional Dependence"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span>  <span class="st">"none"</span><span class="op">)</span>,</span>
<span></span>
<span><span class="va">plts</span><span class="op">$</span><span class="va">H0_plt</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Conditional Independence"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span>  <span class="st">"none"</span><span class="op">)</span>,</span>
<span><span class="va">plts</span><span class="op">$</span><span class="va">ambiguous_plt</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Ambiguous"</span><span class="op">)</span>, </span>
<span>nrow <span class="op">=</span> <span class="fl">1</span>,</span>
<span>rel_widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1.1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/hyp_plot.png"></p>
<p>As can be seen, there is not evidence for conditional independence
for any of the relations. And the ambiguous network makes clear there is
large uncertainty as to what or what might not be the “true” network
structure. This basic idea of having three adjacency matrices was
proposed in <span class="citation">Williams and Mulder
(2019)</span>.</p>
</div>
<div class="section level2">
<h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a>
</h2>
<p><strong>BGGM</strong> provides a publication ready plot, but it is
also limited compared to <strong>qgraph</strong> <span class="citation">(Epskamp et al. 2012)</span>. The one advantage of
<strong>BGGM</strong> is that all plots are <code>ggplots</code> which
then allows for combining them rather easily. An example is included in
another vignette that shows how to combine several plots made with
various methods in <strong>BGGM</strong></p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-epskamp2012qgraph" class="csl-entry">
Epskamp, Sacha, Angélique OJ Cramer, Lourens J Waldorp, Verena D
Schmittmann, Denny Borsboom, et al. 2012. <span>“Qgraph: Network
Visualizations of Relationships in Psychometric Data.”</span>
<em>Journal of Statistical Software</em> 48 (4): 1–18. <a href="https://doi.org/10.18637/jss.v048.i04" class="external-link">https://doi.org/10.18637/jss.v048.i04</a>.
</div>
<div id="ref-Williams2019_bf" class="csl-entry">
Williams, Donald R, and Joris Mulder. 2019. <span>“<span class="nocase">Bayesian Hypothesis Testing for Gaussian Graphical
Models: Conditional Independence and Order Constraints</span>.”</span>
<em>PsyArXiv</em>. <a href="https://doi.org/10.31234/osf.io/ypxd8" class="external-link">https://doi.org/10.31234/osf.io/ypxd8</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Donald Williams, Joris Mulder, Philippe Rast.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
