<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Custom Network Comparisons • BGGM</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Custom Network Comparisons">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BGGM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.3.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/donaldRwilliams/BGGM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Custom Network Comparisons</h1>
                        <h4 data-toc-skip class="author">Donny
Williams</h4>
            
            <h4 data-toc-skip class="date">5/19/2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/donaldRwilliams/BGGM/blob/HEAD/vignettes/ppc_custom.Rmd" class="external-link"><code>vignettes/ppc_custom.Rmd</code></a></small>
      <div class="d-none name"><code>ppc_custom.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>It is quite common to have partial correlation networks (GGMs) for
various subgroups, say, males and females, a control and treatment
group, or perhaps several educational levels. In this case, it is
important to not only determine whether the groups are different, but
actually compare the groups in a way that answers a specific question of
interest.</p>
<p>To date, most <code>R</code> packages provide a few ways to compare
groups, including <strong>BGGM</strong> (version <code>1.0.0</code>). In
version <code>2.0.0</code>, however, <strong>BGGM</strong> includes a
new feature for the function <code>ggm_compare_ppc</code> that enables
users to <strong>compare networks in any way they want</strong>.</p>
</div>
<div class="section level2">
<h2 id="basic-idea">Basic Idea<a class="anchor" aria-label="anchor" href="#basic-idea"></a>
</h2>
<p>The technical details of the approach are described in <span class="citation">(Williams et al. 2020)</span>. The basic idea is to</p>
<ol style="list-style-type: decimal">
<li><p>Draw samples from the posterior distribution, assuming the groups
are equal (i.e., the “null” model).</p></li>
<li>
<p>Generate the posterior <strong>predictive</strong> distribution
for the chosen test-statistic (how the groups are being compared)</p>
<ul>
<li>This can be understood as what we would expect to observe in the
future (e.g., in replication), assuming the groups were in fact
equal.</li>
</ul>
</li>
<li><p>Compute the test-statistic for the observed groups.</p></li>
<li>
<p>Then compare the observed test-statistic to the predictive
distribution (what is expected under the “null” model).</p>
<ul>
<li>If the observed error is larger than the model assuming group
equality, this suggests that the groups are different.</li>
</ul>
</li>
</ol>
<p>In <strong>BGGM</strong>, the default is to compare the groups with
respect to (symmetric) Kullback-Leibler divergence (i.e., “distance”
between multivariate normal distributions) and the sum of squared error
(for the partial correlation matrix). This was shown to be quite
powerful in <span class="citation">Williams et al. (2020)</span>, while
also having a low false positive rate.</p>
<p>In the following, the focus is on defining custom functions and using
them with <code>ggm_compare_ppc</code>. In all examples, post-traumatic
stress disorder networks are compared <span class="citation">(Fried et
al. 2018)</span>.</p>
<div class="section level4">
<h4 id="r-packages">R packages<a class="anchor" aria-label="anchor" href="#r-packages"></a>
</h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># need the developmental version</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span>   </span>
<span><span class="op">}</span>   </span>
<span></span>
<span><span class="co"># install from github</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"donaldRwilliams/BGGM"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h4>
<p>Only the correlation matrices are available. Hence, multivariate
normal data is generated with that <em>exact</em> correlation structure
via the <code>R</code> package <strong>MASS</strong>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># need these packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://donaldrwilliams.github.io/BGGM">BGGM</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">assortnet</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=networktools" class="external-link">networktools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># group 1</span></span>
<span><span class="va">Yg1</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">926</span>, </span>
<span>                     mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">16</span><span class="op">)</span>, </span>
<span>                     Sigma <span class="op">=</span> <span class="va">ptsd_cor3</span>, </span>
<span>                     empirical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># group 2</span></span>
<span><span class="va">Yg2</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">956</span>, </span>
<span>                     mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">16</span><span class="op">)</span>, </span>
<span>                     Sigma <span class="op">=</span> <span class="va">ptsd_cor4</span>, </span>
<span>                     empirical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="illustrative-examples">Illustrative Examples<a class="anchor" aria-label="anchor" href="#illustrative-examples"></a>
</h2>
<div class="section level3">
<h3 id="correlation">Correlation<a class="anchor" aria-label="anchor" href="#correlation"></a>
</h3>
<p>This first example looks at the correlation between partial
correlations of the two networks. Note that it could be two networks
have what is considered a large correlation. However, the question here
is, assuming the groups are equal, just how large should the correlation
be? This is needed to interpret the observed test-statistic.</p>
<div class="section level4">
<h4 id="step-1-define-custom-function">Step 1: Define Custom Function<a class="anchor" aria-label="anchor" href="#step-1-define-custom-function"></a>
</h4>
<p>The first step is to define a custom function that takes two data
matrices and the output is the chosen test-statistic (in this case a
correlation)</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Yg1</span>, <span class="va">Yg2</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># number of nodes</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Yg1</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># index of off-diagonal</span></span>
<span>  <span class="va">indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">upper.tri</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># group 1:</span></span>
<span>  <span class="co"># fit model</span></span>
<span>  <span class="va">g1_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.html">estimate</a></span><span class="op">(</span><span class="va">Yg1</span>, analytic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="co"># pcors</span></span>
<span>  <span class="va">g1_pcors</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pcor_mat.html">pcor_mat</a></span><span class="op">(</span><span class="va">g1_fit</span><span class="op">)</span><span class="op">[</span><span class="va">indices</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># group 2</span></span>
<span>  <span class="co"># fit model</span></span>
<span>  <span class="va">g2_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.html">estimate</a></span><span class="op">(</span><span class="va">Yg2</span>, analytic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="co"># pcors</span></span>
<span>  <span class="va">g2_pcors</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pcor_mat.html">pcor_mat</a></span><span class="op">(</span><span class="va">g2_fit</span><span class="op">)</span><span class="op">[</span><span class="va">indices</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># test-statistic</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">g1_pcors</span>, <span class="va">g2_pcors</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="step-2-compute-the-observed-score">Step 2: Compute the Observed Score<a class="anchor" aria-label="anchor" href="#step-2-compute-the-observed-score"></a>
</h4>
<p>The next step is to compute the observed test-statistic, that is, the
correlation between the partial correlations.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obs</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">Yg1</span>, <span class="va">Yg2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># observed</span></span>
<span><span class="va">obs</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.5399268</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="step-3-predictive-check">Step 3: Predictive Check<a class="anchor" aria-label="anchor" href="#step-3-predictive-check"></a>
</h4>
<p>With the function, <code>f</code>, and the observed scores,
<code>obs</code>, in hand, what is left is the predictive check</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ppc</span> <span class="op">&lt;-</span> <span class="fu">BGGM</span><span class="fu">::</span><span class="fu"><a href="../reference/ggm_compare_ppc.html">ggm_compare_ppc</a></span><span class="op">(</span><span class="va">Yg1</span>, <span class="va">Yg2</span>, </span>
<span>                       FUN <span class="op">=</span> <span class="va">f</span>, </span>
<span>                       custom_obs <span class="op">=</span> <span class="va">obs</span>, </span>
<span>                       iter <span class="op">=</span> <span class="fl">1000</span>, </span>
<span>                       loss <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Note that <code>loss = FALSE</code> controls how the p-value is
computed. It is an indicator of whether the test-statistic is a “loss”
(a bad thing). In this case, a large correlation is a good thing so it
is set to <code>FALSE</code>. The results can then be printed</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ppc</span></span></code></pre></div>
<pre><code><span><span class="co">## BGGM: Bayesian Gaussian Graphical Models </span></span>
<span><span class="co">## --- </span></span>
<span><span class="co">## Test: Global Predictive Check </span></span>
<span><span class="co">## Posterior Samples: 1000 </span></span>
<span><span class="co">##   Group 1: 926 </span></span>
<span><span class="co">##   Group 2: 956 </span></span>
<span><span class="co">## Nodes:  16 </span></span>
<span><span class="co">## Relations: 120 </span></span>
<span><span class="co">## --- </span></span>
<span><span class="co">## Call: </span></span>
<span><span class="co">## BGGM::ggm_compare_ppc(Yg1, Yg2, iter = 1000, FUN = f, custom_obs = obs, </span></span>
<span><span class="co">##     loss = FALSE)</span></span>
<span><span class="co">## --- </span></span>
<span><span class="co">## Custom: </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##    contrast custom.obs p.value</span></span>
<span><span class="co">##  Yg1 vs Yg2       0.54       0</span></span>
<span><span class="co">## ---</span></span></code></pre>
<p>which shows the posterior predictive p-value is zero. This indicates
that the observed correlation is lower than the entire predictive
distribution (the distribution of correlations for future data, assuming
group equality)</p>
<p>and finally plot the results</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ppc</span><span class="op">)</span></span></code></pre></div>
<p><img src="ppc_custom_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>The density is the predictive distribution for the correlation.
Recall that this is the correlation that we would expect, given the
groups were actually the same, and the black point is the observed
correlation. In this case, it seems quite clear that the “null model” is
inadequate–the groups are apparently quite different.</p>
</div>
</div>
<div class="section level3">
<h3 id="hamming-distance">Hamming Distance<a class="anchor" aria-label="anchor" href="#hamming-distance"></a>
</h3>
<p>The next example is <a href="https://en.wikipedia.org/wiki/Hamming_distance" class="external-link">Hamming
distance</a>, which, in this case, is the squared error for the
adjacency matrices. It seems reasonable to think of this as a test for
different network structures or patterns of zeros and ones.</p>
<div class="section level4">
<h4 id="step-1-define-custom-function-1">Step 1: Define Custom Function<a class="anchor" aria-label="anchor" href="#step-1-define-custom-function-1"></a>
</h4>
<p>The first step is to define a custom function that takes two data
matrices and the output is the chosen test-statistic (in this case
Hamming distance)</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Yg1</span>, <span class="va">Yg2</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># nodes</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Yg1</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># index of off-diagonal</span></span>
<span>  <span class="va">indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">upper.tri</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># fit models</span></span>
<span>  <span class="va">fit1</span> <span class="op">&lt;-</span>  <span class="fu">BGGM</span><span class="fu">::</span><span class="fu"><a href="../reference/estimate.html">estimate</a></span><span class="op">(</span><span class="va">Yg1</span>, analytic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">fit2</span> <span class="op">&lt;-</span>  <span class="fu">BGGM</span><span class="fu">::</span><span class="fu"><a href="../reference/estimate.html">estimate</a></span><span class="op">(</span><span class="va">Yg2</span>, analytic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># select graphs</span></span>
<span>  <span class="va">sel1</span> <span class="op">&lt;-</span> <span class="fu">BGGM</span><span class="fu">::</span><span class="fu"><a href="../reference/select.html">select</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span>
<span>  <span class="va">sel2</span> <span class="op">&lt;-</span> <span class="fu">BGGM</span><span class="fu">::</span><span class="fu"><a href="../reference/select.html">select</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># hamming distance</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">sel1</span><span class="op">$</span><span class="va">adj</span><span class="op">[</span><span class="va">indices</span><span class="op">]</span> <span class="op">-</span> <span class="va">sel2</span><span class="op">$</span><span class="va">adj</span><span class="op">[</span><span class="va">indices</span><span class="op">]</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="step-2-compute-the-observed-score-1">Step 2: Compute the Observed Score<a class="anchor" aria-label="anchor" href="#step-2-compute-the-observed-score-1"></a>
</h4>
<p>The next step is to compute the observed test-statistic, that is, the
Hamming distance between adjacency matrices</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obs</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">Yg1</span>, <span class="va">Yg2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># observed</span></span>
<span><span class="va">obs</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 60</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="step-3-predictive-check-1">Step 3: Predictive Check<a class="anchor" aria-label="anchor" href="#step-3-predictive-check-1"></a>
</h4>
<p>With the function, <code>f</code>, and the observed scores,
<code>obs</code>, in hand, what is left is the predictive check</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ppc</span> <span class="op">&lt;-</span> <span class="fu">BGGM</span><span class="fu">::</span><span class="fu"><a href="../reference/ggm_compare_ppc.html">ggm_compare_ppc</a></span><span class="op">(</span><span class="va">Yg1</span>, <span class="va">Yg2</span>, </span>
<span>                       FUN <span class="op">=</span> <span class="va">f</span>, </span>
<span>                       custom_obs <span class="op">=</span> <span class="va">obs</span>, </span>
<span>                       iter <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p>The results can then be printed</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ppc</span></span></code></pre></div>
<pre><code><span><span class="co">## BGGM: Bayesian Gaussian Graphical Models </span></span>
<span><span class="co">## --- </span></span>
<span><span class="co">## Test: Global Predictive Check </span></span>
<span><span class="co">## Posterior Samples: 1000 </span></span>
<span><span class="co">##   Group 1: 926 </span></span>
<span><span class="co">##   Group 2: 956 </span></span>
<span><span class="co">## Nodes:  16 </span></span>
<span><span class="co">## Relations: 120 </span></span>
<span><span class="co">## --- </span></span>
<span><span class="co">## Call: </span></span>
<span><span class="co">## BGGM::ggm_compare_ppc(Yg1, Yg2, iter = 1000, FUN = f, custom_obs = obs)</span></span>
<span><span class="co">## --- </span></span>
<span><span class="co">## Custom: </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##    contrast custom.obs p.value</span></span>
<span><span class="co">##  Yg1 vs Yg2         60       0</span></span>
<span><span class="co">## ---</span></span></code></pre>
<p>And then plot the results</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ppc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $plot_custom</span></span></code></pre>
<p><img src="ppc_custom_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>This result is intriguing. Whereas the correlation looked at the
relation between partial correlation, here there seems to be evidence
that the adjacency matrices are different (perhaps suggesting that the
conditional independence structure is different).</p>
</div>
</div>
<div class="section level3">
<h3 id="partial-correlation-matrix-distance">Partial Correlation Matrix Distance<a class="anchor" aria-label="anchor" href="#partial-correlation-matrix-distance"></a>
</h3>
<p>There might also be interest in the so-called correlation matrix
distance <span class="citation">(Herdin et al. 2005)</span>. This is
also easily tested, in this case for the partial correlation matrix.</p>
<div class="section level4">
<h4 id="step-1-define-custom-function-2">Step 1: Define Custom Function<a class="anchor" aria-label="anchor" href="#step-1-define-custom-function-2"></a>
</h4>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Yg1</span>, <span class="va">Yg2</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># nodes</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Yg1</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># index of off-diagonal</span></span>
<span>  <span class="va">indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">upper.tri</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># fit models</span></span>
<span>  <span class="va">fit1</span> <span class="op">&lt;-</span>  <span class="fu">BGGM</span><span class="fu">::</span><span class="fu"><a href="../reference/estimate.html">estimate</a></span><span class="op">(</span><span class="va">Yg1</span>, analytic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">fit2</span> <span class="op">&lt;-</span>  <span class="fu">BGGM</span><span class="fu">::</span><span class="fu"><a href="../reference/estimate.html">estimate</a></span><span class="op">(</span><span class="va">Yg2</span>, analytic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">pcor1</span> <span class="op">&lt;-</span> <span class="fu">BGGM</span><span class="fu">::</span><span class="fu"><a href="../reference/pcor_mat.html">pcor_mat</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span> </span>
<span>  <span class="va">pcor2</span> <span class="op">&lt;-</span> <span class="fu">BGGM</span><span class="fu">::</span><span class="fu"><a href="../reference/pcor_mat.html">pcor_mat</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># CDM for partial correlations</span></span>
<span>  <span class="co"># note: numerator is the trace; denominator is the Frobenius norm</span></span>
<span>  <span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">pcor1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">pcor2</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/norm.html" class="external-link">norm</a></span><span class="op">(</span><span class="va">pcor1</span>, type <span class="op">=</span> <span class="st">"f"</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/norm.html" class="external-link">norm</a></span><span class="op">(</span><span class="va">pcor2</span>, type <span class="op">=</span> <span class="st">"f"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="step-2-compute-the-observed-score-2">Step 2: Compute the Observed Score<a class="anchor" aria-label="anchor" href="#step-2-compute-the-observed-score-2"></a>
</h4>
<p>The next step is to compute the observed test-statistic, that is, the
Partial Correlation Matrix Distance</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obs</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">Yg1</span>, <span class="va">Yg2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># observed</span></span>
<span><span class="va">obs</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.3430489</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="step-3-predictive-check-2">Step 3: Predictive Check<a class="anchor" aria-label="anchor" href="#step-3-predictive-check-2"></a>
</h4>
<p>With the function, <code>f</code>, and the observed scores,
<code>obs</code>, in hand, what is left is the predictive check</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ppc</span> <span class="op">&lt;-</span> <span class="fu">BGGM</span><span class="fu">::</span><span class="fu"><a href="../reference/ggm_compare_ppc.html">ggm_compare_ppc</a></span><span class="op">(</span><span class="va">Yg1</span>, <span class="va">Yg2</span>, </span>
<span>                       FUN <span class="op">=</span> <span class="va">f</span>, </span>
<span>                       custom_obs <span class="op">=</span> <span class="va">obs</span>, </span>
<span>                       iter <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p>The results can then be printed</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ppc</span></span></code></pre></div>
<pre><code><span><span class="co">## BGGM: Bayesian Gaussian Graphical Models </span></span>
<span><span class="co">## --- </span></span>
<span><span class="co">## Test: Global Predictive Check </span></span>
<span><span class="co">## Posterior Samples: 1000 </span></span>
<span><span class="co">##   Group 1: 926 </span></span>
<span><span class="co">##   Group 2: 956 </span></span>
<span><span class="co">## Nodes:  16 </span></span>
<span><span class="co">## Relations: 120 </span></span>
<span><span class="co">## --- </span></span>
<span><span class="co">## Call: </span></span>
<span><span class="co">## BGGM::ggm_compare_ppc(Yg1, Yg2, iter = 1000, FUN = f, custom_obs = obs)</span></span>
<span><span class="co">## --- </span></span>
<span><span class="co">## Custom: </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##    contrast custom.obs p.value</span></span>
<span><span class="co">##  Yg1 vs Yg2      0.343       0</span></span>
<span><span class="co">## ---</span></span></code></pre>
<p>which again provides a p-value of zero.</p>
<p>Note that the object <code>ppc</code> includes the predictive samples
that allows for user defined plots (in the event something custom is
desired).</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">ppc</span><span class="op">$</span><span class="va">predictive_custom</span>, </span>
<span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">obs</span><span class="op">)</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Partial Correlation Matrix Distance"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">obs</span><span class="op">)</span></span></code></pre></div>
<p><img src="ppc_custom_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<p>Note that the line is the observed which again makes it clear that
the distance is quite surprising, assuming the null model were true.</p>
</div>
</div>
<div class="section level3">
<h3 id="assortment">Assortment<a class="anchor" aria-label="anchor" href="#assortment"></a>
</h3>
<p>This next example is assortment <span class="citation">(Newman
2003)</span>, which is a measure related to clustering in a network.
Here the test is for a difference in assortment. This is computed by
taking the difference (absolute value) for each draw from the predictive
distribution.</p>
<div class="section level4">
<h4 id="step-1-define-custom-function-3">Step 1: Define Custom Function<a class="anchor" aria-label="anchor" href="#step-1-define-custom-function-3"></a>
</h4>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># clusters based on DSM-5</span></span>
<span><span class="va">comms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="fl">7</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Yg1</span>, <span class="va">Yg2</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span>  <span class="va">fit1</span> <span class="op">&lt;-</span>  <span class="fu">BGGM</span><span class="fu">::</span><span class="fu"><a href="../reference/estimate.html">estimate</a></span><span class="op">(</span><span class="va">Yg1</span>, analytic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">fit2</span> <span class="op">&lt;-</span>  <span class="fu">BGGM</span><span class="fu">::</span><span class="fu"><a href="../reference/estimate.html">estimate</a></span><span class="op">(</span><span class="va">Yg2</span>, analytic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">pcor1</span> <span class="op">&lt;-</span> <span class="fu">BGGM</span><span class="fu">::</span><span class="fu"><a href="../reference/pcor_mat.html">pcor_mat</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span>
<span>  <span class="va">pcor2</span> <span class="op">&lt;-</span> <span class="fu">BGGM</span><span class="fu">::</span><span class="fu"><a href="../reference/pcor_mat.html">pcor_mat</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">assort1</span> <span class="op">&lt;-</span> <span class="fu">assortnet</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/assortnet/man/assortment.discrete.html" class="external-link">assortment.discrete</a></span><span class="op">(</span><span class="va">pcor1</span>, types <span class="op">=</span> <span class="va">comms</span>,</span>
<span>                                         weighted <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                         SE <span class="op">=</span> <span class="cn">FALSE</span>, M <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">$</span><span class="va">r</span></span>
<span></span>
<span>  <span class="va">assort2</span> <span class="op">&lt;-</span> <span class="fu">assortnet</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/assortnet/man/assortment.discrete.html" class="external-link">assortment.discrete</a></span><span class="op">(</span><span class="va">pcor2</span>, types <span class="op">=</span> <span class="va">comms</span>,</span>
<span>                                          weighted <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                          SE <span class="op">=</span> <span class="cn">FALSE</span>, M <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">$</span><span class="va">r</span></span>
<span>  <span class="op">(</span><span class="va">assort1</span> <span class="op">-</span> <span class="va">assort2</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="step-2-compute-the-observed-score-3">Step 2: Compute the Observed Score<a class="anchor" aria-label="anchor" href="#step-2-compute-the-observed-score-3"></a>
</h4>
<p>The next step is to compute the observed test-statistic, that is,
assortment for the two groups</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obs</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">Yg1</span>, <span class="va">Yg2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># observed</span></span>
<span><span class="va">obs</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.1915766</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="step-3-predictive-check-3">Step 3: Predictive Check<a class="anchor" aria-label="anchor" href="#step-3-predictive-check-3"></a>
</h4>
<p>With the function, <code>f</code>, and the observed score,
<code>obs</code>, in hand, the next step is the predictive check</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ppc</span> <span class="op">&lt;-</span> <span class="fu">BGGM</span><span class="fu">::</span><span class="fu"><a href="../reference/ggm_compare_ppc.html">ggm_compare_ppc</a></span><span class="op">(</span><span class="va">Yg1</span>, <span class="va">Yg2</span>, </span>
<span>                       FUN <span class="op">=</span> <span class="va">f</span>, </span>
<span>                       custom_obs <span class="op">=</span> <span class="va">obs</span>, </span>
<span>                       iter <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p>The results can then be printed</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ppc</span></span></code></pre></div>
<pre><code><span><span class="co">## BGGM: Bayesian Gaussian Graphical Models </span></span>
<span><span class="co">## --- </span></span>
<span><span class="co">## Test: Global Predictive Check </span></span>
<span><span class="co">## Posterior Samples: 1000 </span></span>
<span><span class="co">##   Group 1: 926 </span></span>
<span><span class="co">##   Group 2: 956 </span></span>
<span><span class="co">## Nodes:  16 </span></span>
<span><span class="co">## Relations: 120 </span></span>
<span><span class="co">## --- </span></span>
<span><span class="co">## Call: </span></span>
<span><span class="co">## BGGM::ggm_compare_ppc(Yg1, Yg2, iter = 1000, FUN = f, custom_obs = obs)</span></span>
<span><span class="co">## --- </span></span>
<span><span class="co">## Custom: </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##    contrast custom.obs p.value</span></span>
<span><span class="co">##  Yg1 vs Yg2      0.192       0</span></span>
<span><span class="co">## ---</span></span></code></pre>
<p>and plotted</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ppc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $plot_custom</span></span></code></pre>
<pre><code><span><span class="co">## Picking joint bandwidth of 0.00663</span></span></code></pre>
<p><img src="ppc_custom_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<p>which shows that the clustering in the data appears to be different
(given the observed value exceeds the entire predictive
distribution).</p>
</div>
</div>
<div class="section level3">
<h3 id="expected-influence">Expected Influence<a class="anchor" aria-label="anchor" href="#expected-influence"></a>
</h3>
<p>This last example looks at the expected influence for the network
<span class="citation">(Robinaugh, Millner, and McNally 2016)</span>. In
this case, the sum of squared error is the test statistic. This is
computed from the squared error for each draw from the predictive
distribution.</p>
<div class="section level4">
<h4 id="step-1-define-custom-function-4">Step 1: Define Custom Function<a class="anchor" aria-label="anchor" href="#step-1-define-custom-function-4"></a>
</h4>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Yg1</span>, <span class="va">Yg2</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span>  <span class="va">fit1</span> <span class="op">&lt;-</span>  <span class="fu">BGGM</span><span class="fu">::</span><span class="fu"><a href="../reference/estimate.html">estimate</a></span><span class="op">(</span><span class="va">Yg1</span>, analytic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">fit2</span> <span class="op">&lt;-</span>  <span class="fu">BGGM</span><span class="fu">::</span><span class="fu"><a href="../reference/estimate.html">estimate</a></span><span class="op">(</span><span class="va">Yg2</span>, analytic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">pcor1</span> <span class="op">&lt;-</span> <span class="fu">BGGM</span><span class="fu">::</span><span class="fu"><a href="../reference/pcor_mat.html">pcor_mat</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span>
<span>  <span class="va">pcor2</span> <span class="op">&lt;-</span> <span class="fu">BGGM</span><span class="fu">::</span><span class="fu"><a href="../reference/pcor_mat.html">pcor_mat</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">ei1</span> <span class="op">&lt;-</span> <span class="fu">networktools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/networktools/man/expectedInf.html" class="external-link">expectedInf</a></span><span class="op">(</span><span class="va">pcor1</span><span class="op">)</span><span class="op">$</span><span class="va">step1</span></span>
<span> </span>
<span>  <span class="va">ei2</span> <span class="op">&lt;-</span> <span class="fu">networktools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/networktools/man/expectedInf.html" class="external-link">expectedInf</a></span><span class="op">(</span><span class="va">pcor2</span><span class="op">)</span><span class="op">$</span><span class="va">step1</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">ei1</span> <span class="op">-</span> <span class="va">ei2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="step-2-compute-the-observed-score-4">Step 2: Compute the Observed Score<a class="anchor" aria-label="anchor" href="#step-2-compute-the-observed-score-4"></a>
</h4>
<p>The next step is to compute the observed test-statistic, that is, the
sum of squared error for expected influence</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obs</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">Yg1</span>, <span class="va">Yg2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># observed</span></span>
<span><span class="va">obs</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.518462</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="step-3-predictive-check-4">Step 3: Predictive Check<a class="anchor" aria-label="anchor" href="#step-3-predictive-check-4"></a>
</h4>
<p>With the function, <code>f</code>, and the observed scores,
<code>obs</code>, in hand, what is left is the predictive check</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ppc</span> <span class="op">&lt;-</span> <span class="fu">BGGM</span><span class="fu">:::</span><span class="fu"><a href="../reference/ggm_compare_ppc.html">ggm_compare_ppc</a></span><span class="op">(</span><span class="va">Yg1</span>, <span class="va">Yg2</span>, </span>
<span>                       FUN <span class="op">=</span> <span class="va">f</span>, </span>
<span>                       custom_obs <span class="op">=</span> <span class="va">obs</span>, </span>
<span>                       iter <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p>The results can then be printed</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ppc</span></span></code></pre></div>
<pre><code><span><span class="co">## BGGM: Bayesian Gaussian Graphical Models </span></span>
<span><span class="co">## --- </span></span>
<span><span class="co">## Test: Global Predictive Check </span></span>
<span><span class="co">## Posterior Samples: 1000 </span></span>
<span><span class="co">##   Group 1: 926 </span></span>
<span><span class="co">##   Group 2: 956 </span></span>
<span><span class="co">## Nodes:  16 </span></span>
<span><span class="co">## Relations: 120 </span></span>
<span><span class="co">## --- </span></span>
<span><span class="co">## Call: </span></span>
<span><span class="co">## BGGM:::ggm_compare_ppc(Yg1, Yg2, iter = 1000, FUN = f, custom_obs = obs)</span></span>
<span><span class="co">## --- </span></span>
<span><span class="co">## Custom: </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##    contrast custom.obs p.value</span></span>
<span><span class="co">##  Yg1 vs Yg2      0.518       0</span></span>
<span><span class="co">## ---</span></span></code></pre>
<p>and plotted</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">ppc</span><span class="op">$</span><span class="va">predictive_custom</span>, </span>
<span>    xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">obs</span><span class="op">)</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Expected Influence\n Sum of Squared Error"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">obs</span><span class="op">)</span></span></code></pre></div>
<p><img src="ppc_custom_files/figure-html/unnamed-chunk-28-1.png" width="700">
which again shows the sum of squared error for expected influence far
exceeds what would be expected, assuming the null model were true.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="two-notes-of-caution">Two Notes of Caution<a class="anchor" aria-label="anchor" href="#two-notes-of-caution"></a>
</h2>
<ol style="list-style-type: decimal">
<li><p>Note that only the default in <strong>BGGM</strong> have been
shown to have nominal error rates. However, there is a proof that
suggests the error rate cannot be larger than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>α</mi></mrow><annotation encoding="application/x-tex">2\alpha</annotation></semantics></math><span class="citation">(Meng et al. 1994)</span>, and, further, a
predictive check is typically below
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math><span class="citation">(i.e., a tendency to be conservative, Gelman et
al. 2013)</span>.</p></li>
<li><p>Failing to reject the null model does not indicate the groups are
the same! To test for equality see <code>ggm_compare_explore</code> and
<code>ggm_compare_confirm</code>.</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>These example certainly open the door for tailoring network
comparison to answer specific research questions.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-fried2018replicability" class="csl-entry">
Fried, Eiko I, Marloes B Eidhof, Sabina Palic, Giulio Costantini, Hilde
M Huisman-van Dijk, Claudi LH Bockting, Iris Engelhard, Cherie Armour,
Anni BS Nielsen, and Karen-Inge Karstoft. 2018. <span>“Replicability and
Generalizability of Posttraumatic Stress Disorder (PTSD) Networks: A
Cross-Cultural Multisite Study of PTSD Symptoms in Four Trauma Patient
Samples.”</span> <em>Clinical Psychological Science</em> 6 (3): 335–51.
</div>
<div id="ref-gelman2013two" class="csl-entry">
Gelman, Andrew et al. 2013. <span>“Two Simple Examples for Understanding
Posterior p-Values Whose Distributions Are Far from Uniform.”</span>
<em>Electronic Journal of Statistics</em> 7: 2595–2602. <a href="https://doi.org/10.1214/13-ejs854" class="external-link">https://doi.org/10.1214/13-ejs854</a>.
</div>
<div id="ref-herdin2005correlation" class="csl-entry">
Herdin, Markus, Nicolai Czink, Hüseyin Ozcelik, and Ernst Bonek. 2005.
<span>“Correlation Matrix Distance, a Meaningful Measure for Evaluation
of Non-Stationary MIMO Channels.”</span> In <em>2005 IEEE 61st Vehicular
Technology Conference</em>, 1:136–40. IEEE. <a href="https://doi.org/10.1109/vetecs.2005.1543265" class="external-link">https://doi.org/10.1109/vetecs.2005.1543265</a>.
</div>
<div id="ref-meng1994posterior" class="csl-entry">
Meng, Xiao-Li et al. 1994. <span>“Posterior Predictive
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-Values.”</span>
<em>The Annals of Statistics</em> 22 (3): 1142–60.
</div>
<div id="ref-newman2003mixing" class="csl-entry">
Newman, Mark EJ. 2003. <span>“Mixing Patterns in Networks.”</span>
<em>Physical Review E</em> 67 (2): 026126.
</div>
<div id="ref-robinaugh2016identifying" class="csl-entry">
Robinaugh, Donald J, Alexander J Millner, and Richard J McNally. 2016.
<span>“Identifying Highly Influential Nodes in the Complicated Grief
Network.”</span> <em>Journal of Abnormal Psychology</em> 125 (6): 747.
</div>
<div id="ref-williams2020comparing" class="csl-entry">
Williams, Donald R, Philippe Rast, Luis R Pericchi, and Joris Mulder.
2020. <span>“Comparing Gaussian Graphical Models with the Posterior
Predictive Distribution and Bayesian Model Selection.”</span>
<em>Psychological Methods</em>. <a href="https://doi.org/10.1037/met0000254" class="external-link">https://doi.org/10.1037/met0000254</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Donald Williams, Joris Mulder, Philippe Rast.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
