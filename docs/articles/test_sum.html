<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Testing Sums • BGGM</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Testing Sums">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BGGM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.5.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rast-lab/BGGM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Testing Sums</h1>
                        <h4 data-toc-skip class="author">Donny
Williams</h4>
            
            <h4 data-toc-skip class="date">5/25/2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/rast-lab/BGGM/blob/HEAD/vignettes/test_sum.Rmd" class="external-link"><code>vignettes/test_sum.Rmd</code></a></small>
      <div class="d-none name"><code>test_sum.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This is a follow-up to the vignette <a href="https://donaldrwilliams.github.io/BGGM/articles/hyp_3_ways.html" class="external-link">“Three
Ways to Test the Same Hypothesis”</a>. A new feature,
<code>pcor_sum</code>, was added to <strong>BGGM</strong> that allows
for testing partial correlation sums. This differs from the Bayes factor
approach (“Approach #3”), in that only the posterior distribution is
used to determine whether there is a difference in the sums.</p>
<div class="section level4">
<h4 id="r-package">R package<a class="anchor" aria-label="anchor" href="#r-package"></a>
</h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># need the developmental version</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span>   </span>
<span><span class="op">}</span>   </span>
<span></span>
<span><span class="co"># install from github</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"donaldRwilliams/BGGM"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rast-lab.github.io/BGGM/">BGGM</a></span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="one-group">One Group<a class="anchor" aria-label="anchor" href="#one-group"></a>
</h2>
<p>This first example looks at one group, where a sum is tested within
the same ptsd network. I focus on the relations between the
re-experiencing (<code>B</code>) and avoidance (<code>C</code>)
communities. In particular, the sum of relations between the “Intrusion”
(5 nodes) community and the “Avoidance” (two nodes) community is
tested.</p>
<div class="section level3">
<h3 id="sum-to-string">Sum to String<a class="anchor" aria-label="anchor" href="#sum-to-string"></a>
</h3>
<p>For the avoidance symptom “avoidance of thoughts” <code>C1</code>,
this can be written in <code>R</code> code with</p>
<pre><code><span><span class="co"># ptsd</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">ptsd</span></span>
<span></span>
<span><span class="co"># paste together sums</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,  <span class="st">"--C1"</span>, collapse <span class="op">=</span> <span class="st">" + "</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#&gt; "B1--C1 + B2--C1 + B3--C1 + B4--C1 + B5--C1"</span></span></code></pre>
<p>whereas, for the avoidance symptom “avoidance of reminders”
(<code>C2</code>), this is written as</p>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,  <span class="st">"--C2"</span>, collapse <span class="op">=</span> <span class="st">" + "</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#&gt; "B1--C2 + B2--C2 + B3--C2 + B4--C2 + B5--C2"</span></span></code></pre>
<p>Note that typically this would have to be written out.
<code>paste0</code> was used in this case to avoid typing out all of the
relations.</p>
</div>
<div class="section level3">
<h3 id="fit-model">Fit Model<a class="anchor" aria-label="anchor" href="#fit-model"></a>
</h3>
<p>Here an ordinal GGM is fitted</p>
<pre><code><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.html">estimate</a></span><span class="op">(</span><span class="va">Y</span><span class="op">+</span><span class="fl">1</span>, type <span class="op">=</span> <span class="st">"ordinal"</span>, iter <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre>
<p>where the <code>+1</code> changes the first category from 0 to 1
(required).</p>
</div>
<div class="section level3">
<h3 id="test-sums">Test Sums<a class="anchor" aria-label="anchor" href="#test-sums"></a>
</h3>
<p>The next step is to use the <code>pcor_sum</code> function. First, I
combine the sums into one string separated with <code>;</code>.</p>
<pre><code><span><span class="co"># sum 1</span></span>
<span><span class="va">sum1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,  <span class="st">"--C1"</span>, collapse <span class="op">=</span> <span class="st">" + "</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># sum 2</span></span>
<span><span class="va">sum2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,  <span class="st">"--C2"</span>, collapse <span class="op">=</span> <span class="st">" + "</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># paste together</span></span>
<span><span class="va">sums</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">sum1</span>, <span class="va">sum2</span>, sep <span class="op">=</span> <span class="st">";"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print</span></span>
<span><span class="va">sums</span></span>
<span><span class="co">#&gt; "B1--C1 + B2--C1 + B3--C1 + B4--C1 + B5--C1;B1--C2 + B2--C2 + B3--C2 + B4--C2 + B5--C2"</span></span></code></pre>
<p>Next <code>pcor_sum</code> is used</p>
<pre><code><span><span class="va">test_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pcor_sum.html">pcor_sum</a></span><span class="op">(</span><span class="va">fit</span>, relations <span class="op">=</span> <span class="va">sums</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print</span></span>
<span><span class="va">test_sum</span></span>
<span></span>
<span><span class="co"># BGGM: Bayesian Gaussian Graphical Models </span></span>
<span><span class="co"># --- </span></span>
<span><span class="co"># Network Stats: Posterior Sum</span></span>
<span><span class="co"># Posterior Samples: 1000 </span></span>
<span><span class="co"># --- </span></span>
<span><span class="co"># Estimates </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Sum: </span></span>
<span><span class="co">#                                    Post.mean Post.sd Cred.lb Cred.ub</span></span>
<span><span class="co"># B1--C1+B2--C1+B3--C1+B4--C1+B5--C1     0.215   0.096   0.034   0.404</span></span>
<span><span class="co"># B1--C2+B2--C2+B3--C2+B4--C2+B5--C2     0.334   0.097   0.145   0.514</span></span>
<span><span class="co"># --- </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Difference:</span></span>
<span><span class="co"># B1--C1+B2--C1+B3--C1+B4--C1+B5--C1 - B1--C2+B2--C2+B3--C2+B4--C2+B5--C2 </span></span>
<span><span class="co"># </span></span>
<span><span class="co">#  Post.mean Post.sd Cred.lb Cred.ub Prob.greater Prob.less</span></span>
<span><span class="co">#     -0.119   0.145  -0.409   0.173        0.205     0.795</span></span>
<span><span class="co"># --- </span></span></code></pre>
<p><code>Prob.greater</code> is the posterior probability that the first
sum is larger than the second sum.</p>
</div>
<div class="section level3">
<h3 id="plot-results">Plot Results<a class="anchor" aria-label="anchor" href="#plot-results"></a>
</h3>
<p>The object <code>test_sum</code> can then be plotted. Note this
returns three plots, but only the difference is shown here</p>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test_sum</span><span class="op">)</span><span class="op">$</span><span class="va">diff</span></span></code></pre>
<p><img src="../reference/figures/test_sum_hist.png"></p>
<p>The histogram is not very smooth in this case because
<code>iter = 1000</code>, but this of course can be changed.</p>
</div>
</div>
<div class="section level2">
<h2 id="two-groups">Two Groups<a class="anchor" aria-label="anchor" href="#two-groups"></a>
</h2>
<p>This next example is for two groups. The data are called
<code>bfi</code> and they are in the <strong>BGGM</strong> package. I
compare a sum of two relations for questions measuring agreeableness in
males and females. The relations tested are as follows</p>
<div class="section level3">
<h3 id="sum-to-string-1">Sum to String<a class="anchor" aria-label="anchor" href="#sum-to-string-1"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sums</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A3--A4 + A4--A5"</span><span class="op">)</span></span></code></pre></div>
<p>where <code>A1</code> is “know how to comfort others”,
<code>A4</code> is “love children”, and <code>A5</code> is “make people
feel at ease”.</p>
</div>
<div class="section level3">
<h3 id="fit-models">Fit Models<a class="anchor" aria-label="anchor" href="#fit-models"></a>
</h3>
<p>The next step is to fit the models</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># data</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">bfi</span></span>
<span></span>
<span><span class="co"># males</span></span>
<span><span class="va">Y_males</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">gender</span> <span class="op">==</span> <span class="fl">1</span>, select <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">education</span>, <span class="va">gender</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># females</span></span>
<span><span class="va">Y_females</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">gender</span> <span class="op">==</span> <span class="fl">2</span>, select <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">education</span>, <span class="va">gender</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span></span>
<span></span>
<span><span class="va">fit_female</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.html">estimate</a></span><span class="op">(</span><span class="va">Y_females</span>, seed <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fit males</span></span>
<span><span class="va">fit_male</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.html">estimate</a></span><span class="op">(</span><span class="va">Y_males</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="test-sums-1">Test Sums<a class="anchor" aria-label="anchor" href="#test-sums-1"></a>
</h3>
<p>Then test the sum</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pcor_sum.html">pcor_sum</a></span><span class="op">(</span><span class="va">fit_female</span>, <span class="va">fit_male</span>, relations <span class="op">=</span> <span class="va">sums</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print</span></span>
<span><span class="va">test_sum</span></span>
<span></span>
<span><span class="co">#&gt; BGGM: Bayesian Gaussian Graphical Models </span></span>
<span><span class="co">#&gt; --- </span></span>
<span><span class="co">#&gt; Network Stats: Posterior Sum</span></span>
<span><span class="co">#&gt; Posterior Samples: 5000 </span></span>
<span><span class="co">#&gt; --- </span></span>
<span><span class="co">#&gt; Estimates </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sum: </span></span>
<span><span class="co">#&gt;                   Post.mean Post.sd Cred.lb Cred.ub</span></span>
<span><span class="co">#&gt; g1: A3--A4+A4--A5     0.292   0.026   0.241   0.342</span></span>
<span><span class="co">#&gt; g2: A3--A4+A4--A5     0.305   0.036   0.234   0.375</span></span>
<span><span class="co">#&gt; --- </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Difference:</span></span>
<span><span class="co">#&gt; g1: A3--A4+A4--A5 - g2: A3--A4+A4--A5 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Post.mean Post.sd Cred.lb Cred.ub Prob.greater Prob.less</span></span>
<span><span class="co">#&gt;     -0.014   0.045    -0.1   0.074        0.386     0.614</span></span>
<span><span class="co">#&gt; --- </span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="sanity-check">Sanity Check<a class="anchor" aria-label="anchor" href="#sanity-check"></a>
</h3>
<p>For a kind of sanity check, here is the sum for the male group
obtained from the point estimates.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pcor_mat.html">pcor_mat</a></span><span class="op">(</span><span class="va">fit_male</span><span class="op">)</span><span class="op">[</span><span class="st">"A3"</span>, <span class="st">"A4"</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="../reference/pcor_mat.html">pcor_mat</a></span><span class="op">(</span><span class="va">fit_male</span><span class="op">)</span><span class="op">[</span><span class="st">"A4"</span>, <span class="st">"A5"</span><span class="op">]</span> </span>
<span></span>
<span><span class="co">#&gt;  0.305</span></span></code></pre></div>
<p>This matches the output.</p>
</div>
</div>
<div class="section level2">
<h2 id="notes">Notes<a class="anchor" aria-label="anchor" href="#notes"></a>
</h2>
<p>By default, the print function for <code>pcor_sum</code> provides 95
% credible intervals. This can be changed by directly using the print
function, for example <code>print(test_sum, cred = 0.99)</code>,
provides 99 % credible intervals.</p>
<p>Currently, this function only supports sums, due to this being of
interest for the psychological network literature in particular. This
can be extended to accommodate multiplication, subtraction, testing
values other than zero, etc. Please make a feature request at either <a href="https://github.com/donaldRwilliams/BGGM/issues" class="external-link">github</a> or <a href="https://groups.google.com/forum/#!forum/bggm-users" class="external-link">BGGM-users
group</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Donald Williams, Joris Mulder, Philippe Rast.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
