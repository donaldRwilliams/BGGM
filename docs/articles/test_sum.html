<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Testing Sums • BGGM</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Testing Sums">
<meta property="og:description" content="BGGM">
<meta property="og:image" content="https://donaldrwilliams.github.io/BGGM/reference/figures/hex.jpg">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@wdonald_1985">
<meta name="twitter:site" content="@wdonald_1985">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BGGM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../articles/installation.html">Troubleshoot</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/donaldRwilliams/BGGM/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Testing Sums</h1>
                        <h4 class="author">Donny Williams</h4>
            
            <h4 class="date">5/25/2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/donaldRwilliams/BGGM/blob/master/vignettes/test_sum.Rmd"><code>vignettes/test_sum.Rmd</code></a></small>
      <div class="hidden name"><code>test_sum.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This is a follow-up to the vignette <a href="https://donaldrwilliams.github.io/BGGM/articles/hyp_3_ways.html">“Three Ways to Test the Same Hypothesis”</a>. A new feature, <code>pcor_sum</code>, was added to <strong>BGGM</strong> that allows for testing partial correlation sums. This differs from the Bayes factor approach (“Approach #3”), in that only the posterior distribution is used to determine whether there is a difference in the sums.</p>
<div id="r-package" class="section level3">
<h3 class="hasAnchor">
<a href="#r-package" class="anchor"></a>R package</h3>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="co"># need the developmental version</span>
<span class="kw">if</span> (!<span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span>(<span class="st">"remotes"</span>)) {
  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"remotes"</span>)
}

<span class="co"># install from github</span>
<span class="kw pkg">remotes</span><span class="kw ns">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span>(<span class="st">"donaldRwilliams/BGGM"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">BGGM</span>)</pre></body></html></div>
</div>
</div>
<div id="one-group" class="section level1">
<h1 class="hasAnchor">
<a href="#one-group" class="anchor"></a>One Group</h1>
<p>This first example looks at one group, where a sum is tested within the same ptsd network. I focus on the relations between the re-experiencing (<code>B</code>) and avoidance (<code>C</code>) communities. In particular, the sum of relations between the “Intrusion” (5 nodes) community and the “Avoidance” (two nodes) community is tested.</p>
<div id="sum-to-string" class="section level2">
<h2 class="hasAnchor">
<a href="#sum-to-string" class="anchor"></a>Sum to String</h2>
<p>For the avoidance symptom “avoidance of thoughts” <code>C1</code>, this can be written in <code>R</code> code with</p>
<pre><code># ptsd
Y &lt;- ptsd

# paste together sums
paste0(colnames(Y)[1:5],  "--C1", collapse = " + ")

#&gt; "B1--C1 + B2--C1 + B3--C1 + B4--C1 + B5--C1"</code></pre>
<p>whereas, for the avoidance symptom “avoidance of reminders” (<code>C2</code>), this is written as</p>
<pre><code>paste0(colnames(Y)[1:5],  "--C2", collapse = " + ")

#&gt; "B1--C2 + B2--C2 + B3--C2 + B4--C2 + B5--C2"</code></pre>
<p>Note that typically this would have to be written out. <code>paste0</code> was used in this case to avoid typing out all of the relations.</p>
</div>
<div id="fit-model" class="section level2">
<h2 class="hasAnchor">
<a href="#fit-model" class="anchor"></a>Fit Model</h2>
<p>Here an ordinal GGM is fitted</p>
<pre><code>fit &lt;- estimate(Y+1, type = "ordinal", iter = 1000)</code></pre>
<p>where the <code>+1</code> changes the first category from 0 to 1 (required).</p>
</div>
<div id="test-sums" class="section level2">
<h2 class="hasAnchor">
<a href="#test-sums" class="anchor"></a>Test Sums</h2>
<p>The next step is to use the <code>pcor_sum</code> function. First, I combine the sums into one string separated with <code>;</code>.</p>
<pre><code># sum 1
sum1 &lt;- paste0(colnames(Y)[1:5],  "--C1", collapse = " + ")

# sum 2
sum2 &lt;- paste0(colnames(Y)[1:5],  "--C2", collapse = " + ")

# paste together
sums &lt;- paste(sum1, sum2, sep = ";")

# print
sums
#&gt; "B1--C1 + B2--C1 + B3--C1 + B4--C1 + B5--C1;B1--C2 + B2--C2 + B3--C2 + B4--C2 + B5--C2"</code></pre>
<p>Next <code>pcor_sum</code> is used</p>
<pre><code>test_sum &lt;- pcor_sum(fit, relations = sums)

# print
test_sum

# BGGM: Bayesian Gaussian Graphical Models 
# --- 
# Network Stats: Posterior Sum
# Posterior Samples: 1000 
# --- 
# Estimates 
# 
# Sum: 
#                                    Post.mean Post.sd Cred.lb Cred.ub
# B1--C1+B2--C1+B3--C1+B4--C1+B5--C1     0.215   0.096   0.034   0.404
# B1--C2+B2--C2+B3--C2+B4--C2+B5--C2     0.334   0.097   0.145   0.514
# --- 
# 
# Difference:
# B1--C1+B2--C1+B3--C1+B4--C1+B5--C1 - B1--C2+B2--C2+B3--C2+B4--C2+B5--C2 
# 
#  Post.mean Post.sd Cred.lb Cred.ub Prob.greater Prob.less
#     -0.119   0.145  -0.409   0.173        0.205     0.795
# --- </code></pre>
<p><code>Prob.greater</code> is the posterior probability that the first sum is larger than the second sum.</p>
</div>
<div id="plot-results" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-results" class="anchor"></a>Plot Results</h2>
<p>The object <code>test_sum</code> can then be plotted. Note this returns three plots, but only the difference is shown here</p>
<pre><code>plot(test_sum)$diff</code></pre>
<p><img src="../man/figures/test_sum_hist.png"></p>
<p>The histogram is not very smooth in this case because <code>iter = 1000</code>, but this of course can be changed.</p>
</div>
</div>
<div id="two-groups" class="section level1">
<h1 class="hasAnchor">
<a href="#two-groups" class="anchor"></a>Two Groups</h1>
<p>This next example is for two groups. The data are called <code>bfi</code> and they are in the <strong>BGGM</strong> package. I compare a sum of two relations for questions measuring agreeableness in males and females. The relations tested are as follows</p>
<div id="sum-to-string-1" class="section level2">
<h2 class="hasAnchor">
<a href="#sum-to-string-1" class="anchor"></a>Sum to String</h2>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">sums</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"A3--A4 + A4--A5"</span>)</pre></body></html></div>
<p>where <code>A1</code> is “know how to comfort others”, <code>A4</code> is “love children”, and <code>A5</code> is “make people feel at ease”.</p>
</div>
<div id="fit-models" class="section level2">
<h2 class="hasAnchor">
<a href="#fit-models" class="anchor"></a>Fit Models</h2>
<p>The next step is to fit the models</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="co"># data</span>
<span class="no">Y</span> <span class="kw">&lt;-</span> <span class="no">bfi</span>

<span class="co"># males</span>
<span class="no">Y_males</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(<span class="no">Y</span>, <span class="no">gender</span> <span class="kw">==</span> <span class="fl">1</span>, <span class="kw">select</span> <span class="kw">=</span> -<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">education</span>, <span class="no">gender</span>))[,<span class="fl">1</span>:<span class="fl">5</span>]

<span class="co"># females</span>
<span class="no">Y_females</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(<span class="no">Y</span>, <span class="no">gender</span> <span class="kw">==</span> <span class="fl">2</span>, <span class="kw">select</span> <span class="kw">=</span> -<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">education</span>, <span class="no">gender</span>))[,<span class="fl">1</span>:<span class="fl">5</span>]


<span class="no">fit_female</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/estimate.html">estimate</a></span>(<span class="no">Y_females</span>, <span class="kw">seed</span> <span class="kw">=</span> <span class="fl">2</span>)

<span class="co"># fit males</span>
<span class="no">fit_male</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/estimate.html">estimate</a></span>(<span class="no">Y_males</span>, <span class="kw">seed</span> <span class="kw">=</span> <span class="fl">1</span>)</pre></body></html></div>
</div>
<div id="test-sums-1" class="section level2">
<h2 class="hasAnchor">
<a href="#test-sums-1" class="anchor"></a>Test Sums</h2>
<p>Then test the sum</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">test_sum</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/pcor_sum.html">pcor_sum</a></span>(<span class="no">fit_female</span>, <span class="no">fit_male</span>, <span class="kw">relations</span> <span class="kw">=</span> <span class="no">sums</span>)

<span class="co"># print</span>
<span class="no">test_sum</span>

<span class="co">#&gt; BGGM: Bayesian Gaussian Graphical Models </span>
<span class="co">#&gt; --- </span>
<span class="co">#&gt; Network Stats: Posterior Sum</span>
<span class="co">#&gt; Posterior Samples: 5000 </span>
<span class="co">#&gt; --- </span>
<span class="co">#&gt; Estimates </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sum: </span>
<span class="co">#&gt;                   Post.mean Post.sd Cred.lb Cred.ub</span>
<span class="co">#&gt; g1: A3--A4+A4--A5     0.292   0.026   0.241   0.342</span>
<span class="co">#&gt; g2: A3--A4+A4--A5     0.305   0.036   0.234   0.375</span>
<span class="co">#&gt; --- </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Difference:</span>
<span class="co">#&gt; g1: A3--A4+A4--A5 - g2: A3--A4+A4--A5 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Post.mean Post.sd Cred.lb Cred.ub Prob.greater Prob.less</span>
<span class="co">#&gt;     -0.014   0.045    -0.1   0.074        0.386     0.614</span>
<span class="co">#&gt; --- </span></pre></body></html></div>
</div>
<div id="sanity-check" class="section level2">
<h2 class="hasAnchor">
<a href="#sanity-check" class="anchor"></a>Sanity Check</h2>
<p>For a kind of sanity check, here is the sum for the male group obtained from the point estimates.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="../reference/pcor_mat.html">pcor_mat</a></span>(<span class="no">fit_male</span>)[<span class="st">"A3"</span>, <span class="st">"A4"</span>] + <span class="fu"><a href="../reference/pcor_mat.html">pcor_mat</a></span>(<span class="no">fit_male</span>)[<span class="st">"A4"</span>, <span class="st">"A5"</span>]

<span class="co">#&gt;  0.305</span></pre></body></html></div>
<p>This matches the output.</p>
</div>
</div>
<div id="notes" class="section level1">
<h1 class="hasAnchor">
<a href="#notes" class="anchor"></a>Notes</h1>
<p>By default, the print function for <code>pcor_sum</code> provides 95 % credible intervals. This can be changed by directly using the print function, for example <code><a href="https://rdrr.io/r/base/print.html">print(test_sum, cred = 0.99)</a></code>, provides 99 % credible intervals.</p>
<p>It would be possible to test the sums for independent groups analytically, assuming there is a solution available (which there is for Spearman, Pearson, etc. partial correlations). This would not work for partial correlations <em>within</em> the same network, as the sum and difference must consider the covariance between relations. This is a nice aspect of Bayesian methods, in that the posterior samples encode the covariance</p>
<p>Currently, this function only supports sums, due to this being of interest for the psychological network literature in particular. This can be extended to accommodate multiplication, subtraction, testing values other than zero, etc. Please make a feature request at either <a href="https://github.com/donaldRwilliams/BGGM/issues">github</a> or <a href="https://groups.google.com/forum/#!forum/bggm-users">BGGM-users group</a>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Donald Williams, Joris Mulder.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
