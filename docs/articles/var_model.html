<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Graphical VAR • BGGM</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Graphical VAR">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BGGM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.5.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rast-lab/BGGM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Graphical VAR</h1>
                        <h4 data-toc-skip class="author">Donny
Williams</h4>
            
            <h4 data-toc-skip class="date">6/04/2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/rast-lab/BGGM/blob/HEAD/vignettes/var_model.Rmd" class="external-link"><code>vignettes/var_model.Rmd</code></a></small>
      <div class="d-none name"><code>var_model.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette describes the implemention for a “graphical VAR” in
<code>BGGM</code>. In <code>BGGM</code>, this is fitted as a
multivariate regression. The key innovation is a novel prior
distribution for the residual covariance matrix. There are a variety of
much cooler names than a <em>mere</em> “multivariate regression”,
including “VAR” (vector autoregressive models) and “TSCGM” (time series
chain graphical model).</p>
<div class="section level3">
<h3 id="r-package">R package<a class="anchor" aria-label="anchor" href="#r-package"></a>
</h3>
<pre><code><span><span class="co"># need the developmental version</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span>   </span>
<span><span class="op">}</span>   </span>
<span></span>
<span><span class="co"># install from github</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"donaldRwilliams/BGGM"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rast-lab.github.io/BGGM/">BGGM</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># for comparsion</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.pfaffikus.de" class="external-link">vars</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># for plotting</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">qgraph</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># combine plots</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h3>
<p>I use data from the ifit (fit bit) study. The data were gathered over
100 consecutive days on a variety of variables, including the PANAS
scale (positive and negative affect) and the number of steps each day.
<code>BGGM</code> includes a subset of variables for two
individuals.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># data</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">subset</span>(ifit, id <span class="sc">==</span> <span class="dv">1</span>)[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co"># first 3 rows</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="fu">head</span>(Y, <span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt;  interested disinterested excited upset strong stressed steps</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt;         72            10      50     2     50       16  7805</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt;         75             6      75     0     76        0 18248</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="sc">&gt;</span><span class="co">#         36            58      38     5     45        1 12139</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="estimation">Estimation<a class="anchor" aria-label="anchor" href="#estimation"></a>
</h2>
<p>The methods in <strong>BGGM</strong> are organized around Bayesian
“estimation” and “hypothesis testing”. This is to reach a broader
audience, as former is more similar to classical methods (those more
familiar to researchers).</p>
<div class="section level3">
<h3 id="fit-model">Fit Model<a class="anchor" aria-label="anchor" href="#fit-model"></a>
</h3>
<p>With the data in hand, the model is fitted as follows</p>
<pre><code><span><span class="co"># fit model</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/var_estimate.html">var_estimate</a></span><span class="op">(</span><span class="va">Y</span>, beta_sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre>
<p>Note that <code>beta_sd</code> is the prior distribution for the
regression coefficients. A smaller value, say,
<code>beta_sd = 0.25</code>, results in a Bayesian ridge regression.
Note also this model, including 5000 draws from the posterior, was
estimated in less than 1 second.</p>
<p>The results can then be printed</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print </span></span>
<span><span class="va">fit</span></span>
<span></span>
<span><span class="co">#&gt; BGGM: Bayesian Gaussian Graphical Models </span></span>
<span><span class="co">#&gt; --- </span></span>
<span><span class="co">#&gt; Vector Autoregressive Model (VAR) </span></span>
<span><span class="co">#&gt; --- </span></span>
<span><span class="co">#&gt; Posterior Samples: 5000 </span></span>
<span><span class="co">#&gt; Observations (n): 94 </span></span>
<span><span class="co">#&gt; Nodes (p): 7 </span></span>
<span><span class="co">#&gt; --- </span></span>
<span><span class="co">#&gt; Call: </span></span>
<span><span class="co">#&gt; var_estimate(Y = Y, beta_sd = 10)</span></span>
<span><span class="co">#&gt; --- </span></span>
<span><span class="co">#&gt; Partial Correlations: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;               interested disinterested excited  upset strong stressed  steps</span></span>
<span><span class="co">#&gt; interested         0.000        -0.170   0.388 -0.217  0.313    0.268  0.089</span></span>
<span><span class="co">#&gt; disinterested     -0.170         0.000  -0.172 -0.029  0.094    0.160 -0.078</span></span>
<span><span class="co">#&gt; excited            0.388        -0.172   0.000 -0.126  0.500   -0.161 -0.016</span></span>
<span><span class="co">#&gt; upset             -0.217        -0.029  -0.126  0.000  0.118    0.350 -0.039</span></span>
<span><span class="co">#&gt; strong             0.313         0.094   0.500  0.118  0.000   -0.010  0.176</span></span>
<span><span class="co">#&gt; stressed           0.268         0.160  -0.161  0.350 -0.010    0.000 -0.038</span></span>
<span><span class="co">#&gt; steps              0.089        -0.078  -0.016 -0.039  0.176   -0.038  0.000</span></span>
<span><span class="co">#&gt; --- </span></span>
<span><span class="co">#&gt; Coefficients: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                  interested disinterested excited  upset strong stressed  steps</span></span>
<span><span class="co">#&gt; interested.l1         0.230        -0.009   0.182 -0.102  0.178    0.018  0.113</span></span>
<span><span class="co">#&gt; disinterested.l1     -0.051        -0.007   0.056 -0.019  0.049    0.091 -0.023</span></span>
<span><span class="co">#&gt; excited.l1           -0.088        -0.196   0.003  0.057 -0.093    0.092  0.106</span></span>
<span><span class="co">#&gt; upset.l1             -0.155         0.262  -0.097  0.435  0.057    0.324 -0.091</span></span>
<span><span class="co">#&gt; strong.l1             0.026         0.182   0.026  0.048  0.189   -0.073 -0.196</span></span>
<span><span class="co">#&gt; stressed.l1          -0.021        -0.014  -0.033 -0.048 -0.079    0.152  0.133</span></span>
<span><span class="co">#&gt; steps.l1             -0.157         0.180  -0.211  0.155 -0.092    0.209  0.042</span></span>
<span><span class="co">#&gt; --- </span></span>
<span><span class="co">#&gt; Date: Thu Jun 04 08:54:04 2020 </span></span></code></pre></div>
<p>Note that the coefficients are comparable, given each variable has
been standardized (e.g., the predictors and the outcome are
standardized). <code>BGGM</code> does not compute the partial directed
correlation (PDC) by default (as in <strong>graphicalVAR</strong>). This
is because the standardized effects can readily be tested with the Bayes
factor, both across and within each model, whereas this does not seem
straightforward for the PDC (which requires a transformation).</p>
<div class="section level4">
<h4 id="compare-to-classical">Compare to Classical<a class="anchor" aria-label="anchor" href="#compare-to-classical"></a>
</h4>
<p>Here are the estimates from the <code>vars</code> package</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span></span>
<span>  <span class="fu">vars</span><span class="fu">::</span><span class="fu">Bcoef</span><span class="op">(</span> </span>
<span>  <span class="fu">vars</span><span class="fu">:::</span><span class="fu">VAR</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>  digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#&gt;                  interested disinterested excited  upset strong stressed  steps</span></span>
<span><span class="co">#&gt; interested.l1         0.229        -0.012   0.184 -0.100  0.180    0.015  0.112</span></span>
<span><span class="co">#&gt; disinterested.l1     -0.050        -0.006   0.057 -0.019  0.050    0.092 -0.022</span></span>
<span><span class="co">#&gt; excited.l1           -0.088        -0.193   0.002  0.056 -0.091    0.093  0.106</span></span>
<span><span class="co">#&gt; upset.l1             -0.155         0.260  -0.096  0.436  0.058    0.321 -0.092</span></span>
<span><span class="co">#&gt; strong.l1             0.027         0.182   0.025  0.047  0.188   -0.073 -0.192</span></span>
<span><span class="co">#&gt; stressed.l1          -0.021        -0.012  -0.033 -0.046 -0.077    0.152  0.133</span></span>
<span><span class="co">#&gt; steps.l1             -0.157         0.183  -0.210  0.153 -0.093    0.207  0.041</span></span></code></pre></div>
<p>Recall that the “estimation” methods are similar to, in this case,
ordinary least squares. The graphical structure in <code>BGGM</code> is
determined with credible intervals, which will be quite similar to using
confidence intervals. Hence for those researchers unfamiliar with
Bayesian methods the “estimation” methods are perhaps a nice place to
start.</p>
</div>
</div>
<div class="section level3">
<h3 id="summarize-model">Summarize Model<a class="anchor" aria-label="anchor" href="#summarize-model"></a>
</h3>
<p>The model can also be summarized with</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span>,  cred <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span>, </span>
<span>  param <span class="op">=</span> <span class="st">"pcor"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">#&gt; BGGM: Bayesian Gaussian Graphical Models </span></span>
<span><span class="co">#&gt; --- </span></span>
<span><span class="co">#&gt; Vector Autoregressive Model (VAR) </span></span>
<span><span class="co">#&gt; --- </span></span>
<span><span class="co">#&gt; Partial Correlations: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                   Relation Post.mean Post.sd Cred.lb Cred.ub</span></span>
<span><span class="co">#&gt;  interested--disinterested    -0.170   0.108  -0.382   0.044</span></span>
<span><span class="co">#&gt;        interested--excited     0.388   0.085   0.219   0.546</span></span>
<span><span class="co">#&gt;     disinterested--excited    -0.172   0.104  -0.369   0.049</span></span>
<span><span class="co">#&gt;          interested--upset    -0.217   0.106  -0.417   0.000</span></span>
<span><span class="co">#&gt;       disinterested--upset    -0.029   0.101  -0.239   0.161</span></span>
<span><span class="co">#&gt;             excited--upset    -0.126   0.098  -0.315   0.066</span></span>
<span><span class="co">#&gt;         interested--strong     0.313   0.090   0.135   0.480</span></span>
<span><span class="co">#&gt;      disinterested--strong     0.094   0.112  -0.120   0.318</span></span>
<span><span class="co">#&gt;            excited--strong     0.500   0.078   0.337   0.645</span></span>
<span><span class="co">#&gt;              upset--strong     0.118   0.109  -0.100   0.325</span></span>
<span><span class="co">#&gt;       interested--stressed     0.268   0.102   0.058   0.460</span></span>
<span><span class="co">#&gt;    disinterested--stressed     0.160   0.100  -0.049   0.351</span></span>
<span><span class="co">#&gt;          excited--stressed    -0.161   0.099  -0.358   0.031</span></span>
<span><span class="co">#&gt;            upset--stressed     0.350   0.091   0.166   0.519</span></span>
<span><span class="co">#&gt;           strong--stressed    -0.010   0.107  -0.212   0.201</span></span>
<span><span class="co">#&gt;          interested--steps     0.089   0.108  -0.123   0.297</span></span>
<span><span class="co">#&gt;       disinterested--steps    -0.078   0.108  -0.284   0.125</span></span>
<span><span class="co">#&gt;             excited--steps    -0.016   0.100  -0.207   0.182</span></span>
<span><span class="co">#&gt;               upset--steps    -0.039   0.107  -0.245   0.178</span></span>
<span><span class="co">#&gt;              strong--steps     0.176   0.101  -0.024   0.364</span></span>
<span><span class="co">#&gt;            stressed--steps    -0.038   0.108  -0.236   0.193</span></span>
<span><span class="co">#&gt; --- </span></span></code></pre></div>
<p>The coefficients can also be printed by changing <code>param</code>
to either <code>all</code> or <code>beta</code>, The summary can also be
plotted. Here are the coefficients</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span>,  cred <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu">plot_grid</span><span class="op">(</span></span>
<span>  <span class="fu">cowplot</span><span class="fu">::</span><span class="fu">plot_grid</span><span class="op">(</span></span>
<span>                   <span class="va">plts</span><span class="op">$</span><span class="va">beta_plt</span><span class="op">$</span><span class="va">interested</span>, </span>
<span>                   <span class="va">plts</span><span class="op">$</span><span class="va">beta_plt</span><span class="op">$</span><span class="va">disinterested</span>, </span>
<span>                   <span class="va">plts</span><span class="op">$</span><span class="va">beta_plt</span><span class="op">$</span><span class="va">excited</span>, </span>
<span>                   nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu">plot_grid</span><span class="op">(</span>  </span>
<span>                   <span class="va">plts</span><span class="op">$</span><span class="va">beta_plt</span><span class="op">$</span><span class="va">upset</span>,</span>
<span>                   <span class="va">plts</span><span class="op">$</span><span class="va">beta_plt</span><span class="op">$</span><span class="va">strong</span>,</span>
<span>                   <span class="va">plts</span><span class="op">$</span><span class="va">beta_plt</span><span class="op">$</span><span class="va">stressed</span>, </span>
<span>                   nrow <span class="op">=</span> <span class="fl">1</span></span>
<span>                  <span class="op">)</span>, </span>
<span>                  nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/var_coef.png"></p>
<p>There is a plot for the partial correlations in the object
<code>plts</code>.</p>
</div>
<div class="section level3">
<h3 id="select-graph">Select Graph<a class="anchor" aria-label="anchor" href="#select-graph"></a>
</h3>
<p>The graphs are selected with</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/select.html">select</a></span><span class="op">(</span><span class="va">fit</span>, cred <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#&gt; BGGM: Bayesian Gaussian Graphical Models </span></span>
<span><span class="co">#&gt; --- </span></span>
<span><span class="co">#&gt; Vector Autoregressive Model (VAR) </span></span>
<span><span class="co">#&gt; --- </span></span>
<span><span class="co">#&gt; Posterior Samples: 5000 </span></span>
<span><span class="co">#&gt; Credible Interval: 95 % </span></span>
<span><span class="co">#&gt; --- </span></span>
<span><span class="co">#&gt; Call: </span></span>
<span><span class="co">#&gt; var_estimate(Y = Y, beta_sd = 10)</span></span>
<span><span class="co">#&gt; --- </span></span>
<span><span class="co">#&gt; Partial Correlations: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;               interested disinterested excited  upset strong stressed steps</span></span>
<span><span class="co">#&gt; interested         0.000             0   0.388 -0.217  0.313    0.268     0</span></span>
<span><span class="co">#&gt; disinterested      0.000             0   0.000  0.000  0.000    0.000     0</span></span>
<span><span class="co">#&gt; excited            0.388             0   0.000  0.000  0.500    0.000     0</span></span>
<span><span class="co">#&gt; upset             -0.217             0   0.000  0.000  0.000    0.350     0</span></span>
<span><span class="co">#&gt; strong             0.313             0   0.500  0.000  0.000    0.000     0</span></span>
<span><span class="co">#&gt; stressed           0.268             0   0.000  0.350  0.000    0.000     0</span></span>
<span><span class="co">#&gt; steps              0.000             0   0.000  0.000  0.000    0.000     0</span></span>
<span><span class="co">#&gt; --- </span></span>
<span><span class="co">#&gt; Coefficients: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                  interested disinterested excited upset strong stressed steps</span></span>
<span><span class="co">#&gt; interested.l1             0         0.000       0 0.000      0    0.000     0</span></span>
<span><span class="co">#&gt; disinterested.l1          0         0.000       0 0.000      0    0.000     0</span></span>
<span><span class="co">#&gt; excited.l1                0         0.000       0 0.000      0    0.000     0</span></span>
<span><span class="co">#&gt; upset.l1                  0         0.262       0 0.435      0    0.324     0</span></span>
<span><span class="co">#&gt; strong.l1                 0         0.000       0 0.000      0    0.000     0</span></span>
<span><span class="co">#&gt; stressed.l1               0         0.000       0 0.000      0    0.000     0</span></span>
<span><span class="co">#&gt; steps.l1                  0         0.000       0 0.000      0    0.209     0</span></span>
<span><span class="co">#&gt; --- </span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="plot-graph">Plot Graph<a class="anchor" aria-label="anchor" href="#plot-graph"></a>
</h2>
<p>For plotting, I use the <strong>qgraph</strong> package.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">qgraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qgraph/man/qgraph.html" class="external-link">qgraph</a></span><span class="op">(</span><span class="va">sel</span><span class="op">$</span><span class="va">pcor_weighted_adj</span>, title <span class="op">=</span> <span class="st">"Partials"</span><span class="op">)</span></span>
<span><span class="fu">qgraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qgraph/man/qgraph.html" class="external-link">qgraph</a></span><span class="op">(</span><span class="va">sel</span><span class="op">$</span><span class="va">beta_weighted_adj</span>, title <span class="op">=</span> <span class="st">"Coefficients"</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/est_net.png"></p>
</div>
<div class="section level2">
<h2 id="predictability">Predictability<a class="anchor" aria-label="anchor" href="#predictability"></a>
</h2>
<p>Finally, it is also possible to compute predictability, in this case
Bayesian
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictability.html">predictability</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print</span></span>
<span><span class="va">r2</span></span>
<span></span>
<span><span class="co">#&gt; BGGM: Bayesian Gaussian Graphical Models </span></span>
<span><span class="co">#&gt; --- </span></span>
<span><span class="co">#&gt; Metric: Bayes R2</span></span>
<span><span class="co">#&gt; Type: continuous </span></span>
<span><span class="co">#&gt; --- </span></span>
<span><span class="co">#&gt; Estimates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           Node Post.mean Post.sd Cred.lb Cred.ub</span></span>
<span><span class="co">#&gt;     interested     0.144   0.057   0.050   0.271</span></span>
<span><span class="co">#&gt;  disinterested     0.166   0.061   0.060   0.302</span></span>
<span><span class="co">#&gt;        excited     0.127   0.054   0.039   0.250</span></span>
<span><span class="co">#&gt;          upset     0.220   0.070   0.093   0.368</span></span>
<span><span class="co">#&gt;         strong     0.116   0.051   0.035   0.232</span></span>
<span><span class="co">#&gt;       stressed     0.227   0.069   0.102   0.373</span></span>
<span><span class="co">#&gt;          steps     0.105   0.047   0.032   0.210</span></span></code></pre></div>
<p>The object <code>r2</code> can also be plotted</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r2</span>, type <span class="op">=</span> <span class="st">"ridgeline"</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/var_ridgeline.png"></p>
</div>
<div class="section level2">
<h2 id="explore">Explore<a class="anchor" aria-label="anchor" href="#explore"></a>
</h2>
<p>Bayesian (exploratory) testing to come…</p>
</div>
<div class="section level2">
<h2 id="confirm">Confirm<a class="anchor" aria-label="anchor" href="#confirm"></a>
</h2>
<p>Bayesian (confirmatory) testing to come…</p>
</div>
<div class="section level2">
<h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a>
</h2>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Donald Williams, Joris Mulder, Philippe Rast.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
