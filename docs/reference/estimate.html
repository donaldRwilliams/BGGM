<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>GGM: Estimation — estimate • BGGM</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="GGM: Estimation — estimate"><meta name="description" content="Estimate the conditional (in)dependence with either an analytic solution or efficiently
sampling from the posterior distribution. These methods were introduced in Williams2019;textualBGGM.
The graph is selected with select.estimate and then plotted with plot.select."><meta property="og:description" content="Estimate the conditional (in)dependence with either an analytic solution or efficiently
sampling from the posterior distribution. These methods were introduced in Williams2019;textualBGGM.
The graph is selected with select.estimate and then plotted with plot.select."><meta property="og:image" content="https://donaldrwilliams.github.io/BGGM/reference/figures/hex.jpg"><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@wdonald_1985"><meta name="twitter:site" content="@wdonald_1985"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BGGM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.3.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/donaldRwilliams/BGGM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>GGM: Estimation</h1>
      <small class="dont-index">Source: <a href="https://github.com/donaldRwilliams/BGGM/blob/HEAD/R/estimate.R" class="external-link"><code>R/estimate.R</code></a></small>
      <div class="d-none name"><code>estimate.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimate the conditional (in)dependence with either an analytic solution or efficiently
sampling from the posterior distribution. These methods were introduced in Williams2019;textualBGGM.
The graph is selected with <code><a href="select.estimate.html">select.estimate</a></code> and then plotted with <code><a href="plot.select.html">plot.select</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">estimate</span><span class="op">(</span></span>
<span>  <span class="va">Y</span>,</span>
<span>  formula <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>  mixed_type <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  analytic <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  prior_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  impute <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-y">Y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Matrix (or data frame) of dimensions <em>n</em> (observations) by  <em>p</em> (variables).</p></dd>


<dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>An object of class <code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></code>. This allows for including
control variables in the model (i.e., <code>~ gender</code>). See the note for further details.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Character string. Which type of data for <code>Y</code> ? The options include <code>continuous</code>,
<code>binary</code>, <code>ordinal</code>, or <code>mixed</code>. Note that mixed can be used for data with only
ordinal variables. See the note for further details.</p></dd>


<dt id="arg-mixed-type">mixed_type<a class="anchor" aria-label="anchor" href="#arg-mixed-type"></a></dt>
<dd><p>Numeric vector. An indicator of length <em>p</em> for which variables should be treated as ranks.
(1 for rank and 0 to assume normality). The default is currently to treat all integer variables as ranks
when <code>type = "mixed"</code> and <code>NULL</code> otherwise. See note for further details.</p></dd>


<dt id="arg-analytic">analytic<a class="anchor" aria-label="anchor" href="#arg-analytic"></a></dt>
<dd><p>Logical. Should the analytic solution be computed (default is <code>FALSE</code>)?</p></dd>


<dt id="arg-prior-sd">prior_sd<a class="anchor" aria-label="anchor" href="#arg-prior-sd"></a></dt>
<dd><p>Scale of the prior distribution, approximately the standard deviation of a beta distribution
(defaults to sqrt(1/3)).</p></dd>


<dt id="arg-iter">iter<a class="anchor" aria-label="anchor" href="#arg-iter"></a></dt>
<dd><p>Number of iterations (posterior samples; defaults to 5000).</p></dd>


<dt id="arg-impute">impute<a class="anchor" aria-label="anchor" href="#arg-impute"></a></dt>
<dd><p>Logical. Should the missing values (<code>NA</code>)
be imputed during model fitting (defaults to <code>TRUE</code>) ?</p></dd>


<dt id="arg-progress">progress<a class="anchor" aria-label="anchor" href="#arg-progress"></a></dt>
<dd><p>Logical. Should a progress bar be included (defaults to <code>TRUE</code>) ?</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>An integer for the random seed.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Currently ignored.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The returned object of class <code>estimate</code> contains a lot of information that
        is used for printing and plotting the results. For users of <strong>BGGM</strong>, the following
        are the useful objects:</p>
<ul><li><p><code>pcor_mat</code> Partial correltion matrix (posterior mean).</p></li>
<li><p><code>post_samp</code> An object containing the posterior samples.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The default is to draw samples from the posterior distribution (<code>analytic = FALSE</code>). The samples are
required for computing edge differences (see <code><a href="ggm_compare_estimate.html">ggm_compare_estimate</a></code>), Bayesian R2 introduced in
gelman_r2_2019;textualBGGM (see <code><a href="predictability.html">predictability</a></code>), etc. If the goal is
to *only* determine the non-zero effects, this can be accomplished by setting <code>analytic = TRUE</code>.
This is particularly useful when a fast solution is needed (see the examples in <code><a href="ggm_compare_ppc.html">ggm_compare_ppc</a></code>)</p>
<p><strong>Controlling for Variables</strong>:</p>
<p>When controlling for variables, it is assumed that <code>Y</code> includes <em>only</em>
the nodes in the GGM and the control variables. Internally, <code>only</code> the predictors
that are included in <code>formula</code> are removed from <code>Y</code>. This is not behavior of, say,
<code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code>, but was adopted to ensure  users do not have to write out each variable that
should be included in the GGM. An example is provided below.</p>
<p><strong>Mixed Type</strong>:</p>
<p>The term "mixed" is somewhat of a misnomer, because the method can be used for data including <em>only</em>
 continuous or <em>only</em> discrete variables. This is based on the ranked likelihood which requires sampling
 the ranks for each variable (i.e., the data is not merely transformed to ranks). This is computationally
 expensive when there are many levels. For example, with continuous data, there are as many ranks
 as data points!</p>
<p>The option <code>mixed_type</code> allows the user to determine  which variable should be treated as ranks
 and the "emprical" distribution is used otherwise hoff2007extendingBGGM. This is
 accomplished by specifying an indicator vector of length <em>p</em>. A one indicates to use the ranks,
 whereas a zero indicates to "ignore" that variable. By default all integer variables are treated as ranks.</p>
<p><strong>Dealing with Errors</strong>:</p>
<p>An error is most likely to arise when <code>type = "ordinal"</code>. The are two common errors (although still rare):</p>
<ul><li><p>The first is due to sampling the thresholds, especially when the data is heavily skewed.
      This can result in an ill-defined matrix. If this occurs, we recommend to first try
      decreasing <code>prior_sd</code> (i.e., a more informative prior). If that does not work, then
      change the data type to <code>type = mixed</code> which then estimates a copula GGM
      (this method can be used for data containing <strong>only</strong> ordinal variable). This should
      work without a problem.</p></li>
<li><p>The second is due to how the ordinal data are categorized. For example, if the error states
       that the index is out of bounds, this indicates that the first category is a zero. This is not allowed, as
       the first category must be one. This is addressed by adding one (e.g., <code>Y + 1</code>) to the data matrix.</p></li>
</ul><p><strong>Imputing Missing Values</strong>:</p>
<p>Missing values are imputed with the approach described in hoff2009first;textualBGGM.
The basic idea is to impute the missing values with the respective posterior pedictive distribution,
given the observed data, as the model is being estimated. Note that the default is <code>TRUE</code>,
but this ignored when there are no missing values. If set to <code>FALSE</code>, and there are missing
values, list-wise deletion is performed with <code>na.omit</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p><strong>Posterior Uncertainty</strong>:</p>
<p>A key feature of <b>BGGM</b> is that there is a posterior distribution for each partial correlation.
This readily allows for visiualizing uncertainty in the estimates. This feature works
with all data types and is accomplished by plotting the summary of the <code>estimate</code> object
(i.e., <code>plot(summary(fit))</code>). Several examples are provided below.</p>


<p><strong>Interpretation of Conditional (In)dependence Models for Latent Data</strong>:</p>
<p>See <code><a href="BGGM-package.html">BGGM-package</a></code> for details about interpreting GGMs based on latent data
(i.e, all data types besides <code>"continuous"</code>)</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># note: iter = 250 for demonstrative purposes</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#########################################</span></span></span>
<span class="r-in"><span><span class="co">### example 1: continuous and ordinal ###</span></span></span>
<span class="r-in"><span><span class="co">#########################################</span></span></span>
<span class="r-in"><span><span class="co"># data</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">ptsd</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># continuous</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit model</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">estimate</span><span class="op">(</span><span class="va">Y</span>, type <span class="op">=</span> <span class="st">"continuous"</span>,</span></span>
<span class="r-in"><span>                iter <span class="op">=</span> <span class="fl">250</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> BGGM: Posterior Sampling </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> BGGM: Finished</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># summarize the partial correlations</span></span></span>
<span class="r-in"><span><span class="va">summ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot the summary</span></span></span>
<span class="r-in"><span><span class="va">plt_summ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># select the graph</span></span></span>
<span class="r-in"><span><span class="va">E</span> <span class="op">&lt;-</span> <span class="fu"><a href="select.html">select</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot the selected graph</span></span></span>
<span class="r-in"><span><span class="va">plt_E</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="select.html">select</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ordinal</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit model (note + 1, due to zeros)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">estimate</span><span class="op">(</span><span class="va">Y</span> <span class="op">+</span> <span class="fl">1</span>, type <span class="op">=</span> <span class="st">"ordinal"</span>,</span></span>
<span class="r-in"><span>                iter <span class="op">=</span> <span class="fl">250</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> BGGM: Posterior Sampling </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> BGGM: Finished</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># summarize the partial correlations</span></span></span>
<span class="r-in"><span><span class="va">summ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot the summary</span></span></span>
<span class="r-in"><span><span class="va">plt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># select the graph</span></span></span>
<span class="r-in"><span><span class="va">E</span> <span class="op">&lt;-</span> <span class="fu"><a href="select.html">select</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot the selected graph</span></span></span>
<span class="r-in"><span><span class="va">plt_E</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="select.html">select</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##################################</span></span></span>
<span class="r-in"><span><span class="co">## example 2: analytic solution ##</span></span></span>
<span class="r-in"><span><span class="co">##################################</span></span></span>
<span class="r-in"><span><span class="co"># (only continuous)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># data</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">ptsd</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit model</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">estimate</span><span class="op">(</span><span class="va">Y</span>, analytic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># summarize the partial correlations</span></span></span>
<span class="r-in"><span><span class="va">summ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot summary</span></span></span>
<span class="r-in"><span><span class="va">plt_summ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># select graph</span></span></span>
<span class="r-in"><span><span class="va">E</span> <span class="op">&lt;-</span> <span class="fu"><a href="select.html">select</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot the selected graph</span></span></span>
<span class="r-in"><span><span class="va">plt_E</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="select.html">select</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Donald Williams, Joris Mulder, Philippe Rast.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

