<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>GGM Compare: Posterior Predictive Check — ggm_compare_ppc • BGGM</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="GGM Compare: Posterior Predictive Check — ggm_compare_ppc"><meta name="description" content="Compare GGMs with a posterior predicitve check gelman1996posteriorBGGM.
This method was introduced in williams2020comparing;textualBGGM. Currently,
there is a global (the entire GGM) and a nodewise test. The default
is to compare GGMs with respect to the posterior predictive distribution of Kullback
Leibler divergence and the sum of squared errors. It is also possible to compare the
GGMs with a user defined test-statistic."><meta property="og:description" content="Compare GGMs with a posterior predicitve check gelman1996posteriorBGGM.
This method was introduced in williams2020comparing;textualBGGM. Currently,
there is a global (the entire GGM) and a nodewise test. The default
is to compare GGMs with respect to the posterior predictive distribution of Kullback
Leibler divergence and the sum of squared errors. It is also possible to compare the
GGMs with a user defined test-statistic."><meta property="og:image" content="https://donaldrwilliams.github.io/BGGM/reference/figures/hex.jpg"><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@wdonald_1985"><meta name="twitter:site" content="@wdonald_1985"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BGGM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.3.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/donaldRwilliams/BGGM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>GGM Compare: Posterior Predictive Check</h1>
      <small class="dont-index">Source: <a href="https://github.com/donaldRwilliams/BGGM/blob/HEAD/R/ggm_compare_ppc.default.R" class="external-link"><code>R/ggm_compare_ppc.default.R</code></a></small>
      <div class="d-none name"><code>ggm_compare_ppc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compare GGMs with a posterior predicitve check gelman1996posteriorBGGM.
This method was introduced in williams2020comparing;textualBGGM. Currently,
there is a <code>global</code> (the entire GGM) and a <code>nodewise</code> test. The default
is to compare GGMs with respect to the posterior predictive distribution of Kullback
Leibler divergence and the sum of squared errors. It is also possible to compare the
GGMs with a user defined test-statistic.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ggm_compare_ppc</span><span class="op">(</span></span>
<span>  <span class="va">...</span>,</span>
<span>  test <span class="op">=</span> <span class="st">"global"</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  FUN <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  custom_obs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  loss <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>At least two matrices (or data frames) of dimensions <em>n</em> (observations) by  <em>p</em> (variables).</p></dd>


<dt id="arg-test">test<a class="anchor" aria-label="anchor" href="#arg-test"></a></dt>
<dd><p>Which test should be performed (defaults to <code>"global"</code>) ? The options include
<code>global</code> and <code>nodewise</code>.</p></dd>


<dt id="arg-iter">iter<a class="anchor" aria-label="anchor" href="#arg-iter"></a></dt>
<dd><p>Number of replicated datasets used to construct the predictivie distribution
(defaults to 5000).</p></dd>


<dt id="arg-fun">FUN<a class="anchor" aria-label="anchor" href="#arg-fun"></a></dt>
<dd><p>An optional function for comparing GGMs that returns a number. See <strong>Details</strong>.</p></dd>


<dt id="arg-custom-obs">custom_obs<a class="anchor" aria-label="anchor" href="#arg-custom-obs"></a></dt>
<dd><p>Number corresponding to the observed score for comparing the GGMs. This is
required if a function is provided in <code>FUN</code>. See <strong>Details</strong>.</p></dd>


<dt id="arg-loss">loss<a class="anchor" aria-label="anchor" href="#arg-loss"></a></dt>
<dd><p>Logical. If a function is provided, is the measure a "loss function"
(i.e., a large score is bad thing). This determines how the <em>p</em>-value
is computed. See <strong>Details</strong>.</p></dd>


<dt id="arg-progress">progress<a class="anchor" aria-label="anchor" href="#arg-progress"></a></dt>
<dd><p>Logical. Should a progress bar be included (defaults to <code>TRUE</code>) ?</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The returned object of class <code>ggm_compare_ppc</code> contains a lot of information that
        is used for printing and plotting the results. For users of <strong>BGGM</strong>, the following
        are the useful objects:</p>
<p><code>test = "global"</code></p>
<ul><li><p><code>ppp_jsd</code> posterior predictive <em>p</em>-values (JSD).</p></li>
<li><p><code>ppp_sse</code> posterior predictive <em>p</em>-values (SSE).</p></li>
<li><p><code>predictive_jsd</code> list containing the posterior predictive distributions (JSD).</p></li>
<li><p><code>predictive_sse</code> list containing the posterior predictive distributions (SSE).</p></li>
<li><p><code>obs_jsd</code> list containing the observed error (JSD).</p></li>
<li><p><code>obs_sse</code> list containing the observed error (SSE).</p></li>
</ul><p><code>test = "nodewise"</code></p>
<ul><li><p><code>ppp_jsd</code> posterior predictive <em>p</em>-values (JSD).</p></li>
<li><p><code>predictive_jsd</code> list containing the posterior predictive distributions (JSD).</p></li>
<li><p><code>obs_jsd</code> list containing the observed error (JSD).</p></li>
</ul><p><code>FUN = f()</code></p>
<ul><li><p><code>ppp_custom</code> posterior predictive <em>p</em>-values (custom).</p></li>
<li><p><code>predictive_custom</code> posterior predictive distributions (custom).</p></li>
<li><p><code>obs_custom</code> observed error (custom).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>FUN</code> argument allows for a user defined test-statisic (the measure used to compare the GGMs).
The function must include only two agruments, each of which corresponds to a dataset. For example,
<code>f &lt;- function(Yg1, Yg2)</code>, where each Y is dataset of dimensions <em>n</em> by <em>p</em>. The
groups are then compare within the function, returning a single number. An example is provided below.</p>
<p>Further, when using a custom function care must be taken when specifying the argument <code>loss</code>.
We recommended to visualize the results with <code>plot</code> to ensure the <em>p</em>-value was computed
in the right direction.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p><strong>Interpretation</strong>:</p>
<p>The primary test-statistic is symmetric KL-divergence that is termed Jensen-Shannon divergence (JSD).
This is in essence a likelihood ratio that provides the "distance" between two multivariate normal
distributions. The basic idea is to (1) compute the posterior predictive distribution, assuming group equality
(the null model). This provides the error that we would expect to see under the null model; (2) compute
JSD for the observed groups; and (3) compare the observed JSD to the posterior predictive distribution,
from which a posterior predictive <em>p</em>-value is computed.</p>
<p>For the <code>global</code> check, the sum of squared error is also provided.
This is computed from the partial correlation matrices and it is analagous
to the strength test in van2017comparing;textualBGGM. The <code>nodewise</code>
test compares the posterior predictive distribution for each node. This is based on the correspondence
between the inverse covariance matrix and multiple regresssion kwan2014regression,Stephens1998BGGM.</p>
<p>If the null model is <code>not</code> rejected, note that this does <code>not</code> provide evidence for equality!
Further, if the null model is rejected, this means that the assumption of group equality is not tenable–the
groups are different.</p>
<p><strong>Alternative Methods</strong>:</p>
<p>There are several methods in <strong>BGGM</strong> for comparing groups. See
<code><a href="ggm_compare_estimate.html">ggm_compare_estimate</a></code> (posterior differences for the
partial correlations), <code><a href="ggm_compare_explore.html">ggm_compare_explore</a></code> (exploratory hypothesis testing),
and <code><a href="ggm_compare_confirm.html">ggm_compare_confirm</a></code> (confirmatory hypothesis testing).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># note: iter = 250 for demonstrative purposes</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># data</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">bfi</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#############################</span></span></span>
<span class="r-in"><span><span class="co">######### global ############</span></span></span>
<span class="r-in"><span><span class="co">#############################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># males</span></span></span>
<span class="r-in"><span><span class="va">Ym</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">gender</span> <span class="op">==</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>             select <span class="op">=</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">gender</span>, <span class="va">education</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># females</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Yf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">gender</span> <span class="op">==</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>             select <span class="op">=</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">gender</span>, <span class="va">education</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">global_test</span> <span class="op">&lt;-</span> <span class="fu">ggm_compare_ppc</span><span class="op">(</span><span class="va">Ym</span>, <span class="va">Yf</span>,</span></span>
<span class="r-in"><span>                               iter <span class="op">=</span> <span class="fl">250</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> BGGM: Predictive Check (Contrast 1)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> BGGM: Finished</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">global_test</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BGGM: Bayesian Gaussian Graphical Models </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test: Global Predictive Check </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Posterior Samples: 250 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Group 1: 805 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Group 2: 1631 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Nodes:  25 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Relations: 300 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ggm_compare_ppc(Ym, Yf, iter = 250)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Symmetric KL divergence (JSD): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    contrast JSD.obs p_value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Yg1 vs Yg2   0.442       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sum of Squared Error: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    contrast SSE.obs p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Yg1 vs Yg2   0.759       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> note:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> JSD is Jensen-Shannon divergence </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#############################</span></span></span>
<span class="r-in"><span><span class="co">###### custom function ######</span></span></span>
<span class="r-in"><span><span class="co">#############################</span></span></span>
<span class="r-in"><span><span class="co"># example 1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># maximum difference van Borkulo et al. (2017)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Yg1</span>, <span class="va">Yg2</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># remove NA</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">Yg1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">Yg2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># nodes</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Yg1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># identity matrix</span></span></span>
<span class="r-in"><span><span class="va">I_p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># partial correlations</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pcor_1</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov2cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="va">I_p</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pcor_2</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov2cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="va">I_p</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># max difference</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="op">(</span><span class="va">pcor_1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">upper.tri</a></span><span class="op">(</span><span class="va">I_p</span><span class="op">)</span><span class="op">]</span> <span class="op">-</span> <span class="va">pcor_2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">upper.tri</a></span><span class="op">(</span><span class="va">I_p</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># observed difference</span></span></span>
<span class="r-in"><span><span class="va">obs</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">Ym</span>, <span class="va">Yf</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">global_max</span> <span class="op">&lt;-</span> <span class="fu">ggm_compare_ppc</span><span class="op">(</span><span class="va">Ym</span>, <span class="va">Yf</span>,</span></span>
<span class="r-in"><span>                              iter <span class="op">=</span> <span class="fl">250</span>,</span></span>
<span class="r-in"><span>                              FUN <span class="op">=</span> <span class="va">f</span>,</span></span>
<span class="r-in"><span>                              custom_obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                              progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">global_max</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BGGM: Bayesian Gaussian Graphical Models </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test: Global Predictive Check </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Posterior Samples: 250 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Group 1: 805 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Group 2: 1631 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Nodes:  25 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Relations: 300 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ggm_compare_ppc(Ym, Yf, iter = 250, FUN = f, custom_obs = obs, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     progress = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Custom: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    contrast custom.obs p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Yg1 vs Yg2       0.16    0.02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># example 2</span></span></span>
<span class="r-in"><span><span class="co"># Hamming distance (squared error for adjacency)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Yg1</span>, <span class="va">Yg2</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># remove NA</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">Yg1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">Yg2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># nodes</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># identity matrix</span></span></span>
<span class="r-in"><span><span class="va">I_p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit1</span> <span class="op">&lt;-</span>  <span class="fu"><a href="estimate.html">estimate</a></span><span class="op">(</span><span class="va">x</span>, analytic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit2</span> <span class="op">&lt;-</span>  <span class="fu"><a href="estimate.html">estimate</a></span><span class="op">(</span><span class="va">y</span>, analytic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sel1</span> <span class="op">&lt;-</span> <span class="fu"><a href="select.html">select</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sel2</span> <span class="op">&lt;-</span> <span class="fu"><a href="select.html">select</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">sel1</span><span class="op">$</span><span class="va">adj</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">upper.tri</a></span><span class="op">(</span><span class="va">I_p</span><span class="op">)</span><span class="op">]</span> <span class="op">-</span> <span class="va">sel2</span><span class="op">$</span><span class="va">adj</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">upper.tri</a></span><span class="op">(</span><span class="va">I_p</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># observed difference</span></span></span>
<span class="r-in"><span><span class="va">obs</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">Ym</span>, <span class="va">Yf</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">global_hd</span> <span class="op">&lt;-</span> <span class="fu">ggm_compare_ppc</span><span class="op">(</span><span class="va">Ym</span>, <span class="va">Yf</span>,</span></span>
<span class="r-in"><span>                            iter <span class="op">=</span> <span class="fl">250</span>,</span></span>
<span class="r-in"><span>                            FUN <span class="op">=</span> <span class="va">f</span>,</span></span>
<span class="r-in"><span>                            custom_obs  <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                            progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">global_hd</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BGGM: Bayesian Gaussian Graphical Models </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test: Global Predictive Check </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Posterior Samples: 250 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Group 1: 805 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Group 2: 1631 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Nodes:  25 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Relations: 300 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ggm_compare_ppc(Ym, Yf, iter = 250, FUN = f, custom_obs = obs, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     progress = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Custom: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    contrast custom.obs p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Yg1 vs Yg2         75     0.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#############################</span></span></span>
<span class="r-in"><span><span class="co">########  nodewise ##########</span></span></span>
<span class="r-in"><span><span class="co">#############################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">nodewise</span> <span class="op">&lt;-</span> <span class="fu">ggm_compare_ppc</span><span class="op">(</span><span class="va">Ym</span>, <span class="va">Yf</span>, iter <span class="op">=</span> <span class="fl">250</span>,</span></span>
<span class="r-in"><span>                           test <span class="op">=</span> <span class="st">"nodewise"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> BGGM: Predictive Check (Contrast 1)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> BGGM: Finished</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">nodewise</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BGGM: Bayesian Gaussian Graphical Models </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test: Nodewise Predictive Check </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Posterior Samples: 250 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Group 1: 805 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Group 2: 1631 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Nodes:  25 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Relations: 300 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ggm_compare_ppc(Ym, Yf, test = "nodewise", iter = 250)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Symmetric KL divergence (JSD): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Yg1 vs Yg2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Node JSD.obs p_value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1   0.001   0.648</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2   0.000   0.952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3   0.006   0.088</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     4   0.005   0.252</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     5   0.006   0.064</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     6   0.002   0.472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     7   0.000   0.776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     8   0.000   0.856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     9   0.000   0.936</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    10   0.003   0.216</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    11   0.020   0.016</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    12   0.009   0.020</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    13   0.003   0.284</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    14   0.004   0.112</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    15   0.011   0.016</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    16   0.001   0.464</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    17   0.000   0.616</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    18   0.000   0.636</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    19   0.000   0.764</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    20   0.000   0.708</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    21   0.000   0.892</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    22   0.003   0.484</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    23   0.002   0.376</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    24   0.013   0.176</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    25   0.018   0.044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> note:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> JSD is Jensen-Shannon divergence </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Donald Williams, Joris Mulder, Philippe Rast.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

